# 2021年 早稲田大学 商学部 数学 解答

## 大問1

### 1. 問題

三角形 $ABC$ において，$\angle B=2\alpha,\ \angle C=2\beta$ とする。
$$
\tan\alpha\tan\beta=x,\qquad \frac{AB+AC}{BC}=y
$$
とするとき，$y$ を $x$ で表せ。

### 1. 解答

正弦定理を用いる。

三角形 $ABC$ で、辺の長さの比は
$$
AB:AC:BC=\sin\angle C:\sin\angle B:\sin\angle A.
$$

ここで
$$
\angle B=2\alpha,\quad \angle C=2\beta,
$$
より
$$
\angle A=\pi-2\alpha-2\beta.
$$
したがって
$$
\sin\angle A=\sin(2\alpha+2\beta).
$$

よって
$$
y=\frac{AB+AC}{BC}
=\frac{\sin 2\beta+\sin 2\alpha}{\sin(2\alpha+2\beta)}.
$$

和積公式
$$
\sin p+\sin q=2\sin\frac{p+q}{2}\cos\frac{p-q}{2}
$$
を用いると
$$
\sin 2\alpha+\sin 2\beta
=2\sin(\alpha+\beta)\cos(\alpha-\beta).
$$

また
$$
\sin(2\alpha+2\beta)=2\sin(\alpha+\beta)\cos(\alpha+\beta).
$$

したがって
$$
y=\frac{\cos(\alpha-\beta)}{\cos(\alpha+\beta)}.
$$

ここで
$$
\cos(\alpha-\beta)=\cos\alpha\cos\beta+\sin\alpha\sin\beta
=\cos\alpha\cos\beta(1+\tan\alpha\tan\beta),
$$
$$
\cos(\alpha+\beta)=\cos\alpha\cos\beta-\sin\alpha\sin\beta
=\cos\alpha\cos\beta(1-\tan\alpha\tan\beta).
$$

よって
$$
y=\frac{1+\tan\alpha\tan\beta}{1-\tan\alpha\tan\beta}.
$$

$x=\tan\alpha\tan\beta$ より
$$
\boxed{y=\frac{1+x}{1-x}}
$$
である。

### 2. 問題

$n$ を正の整数とする。$f(x)$ は $x$ の $n+1$ 次式で表される関数で，$x$ が $0$ 以上 $n$ 以下の整数のとき $f(x)=0$ であり，$f(n+1)=n+1$ である。このとき，
$$
\sum_{k=0}^{n}\frac{(1-\sqrt{2})^k}{f'(k)} > 2^{2021}
$$
を満たす最小の $n$ を求めよ。

### 2. 解答

条件より、$f(x)$ は $0,1,2,\ldots,n$ を根にもつ $n+1$ 次式だから
$$
f(x)=c\prod_{j=0}^{n}(x-j)
$$
と書ける。

条件 $f(n+1)=n+1$ を用いると
$$
f(n+1)=c\prod_{j=0}^{n}(n+1-j)=c(n+1)!=n+1.
$$
よって
$$
c=\frac{1}{n!}.
$$

したがって
$$
f(x)=\frac{1}{n!}\prod_{j=0}^{n}(x-j).
$$

#### $f'(k)$ の計算

積の微分の性質より、根 $k$ における導関数は
$$
f'(k)=\frac{1}{n!}\prod_{\substack{j=0\\j\ne k}}^{n}(k-j).
$$

ここで
$$
\prod_{j=0}^{k-1}(k-j)=k!,
\qquad
\prod_{j=k+1}^{n}(k-j)=(-1)^{n-k}(n-k)!.
$$

よって
$$
f'(k)=\frac{(-1)^{n-k}k!(n-k)!}{n!}
=\frac{(-1)^{n-k}}{\binom{n}{k}}.
$$

したがって
$$
\frac{1}{f'(k)}=(-1)^{n-k}\binom{n}{k}.
$$

#### 和の計算

求める和を $S_n$ とおくと
$$
S_n=\sum_{k=0}^{n}(1-\sqrt2)^k\frac{1}{f'(k)}
=\sum_{k=0}^{n}(1-\sqrt2)^k(-1)^{n-k}\binom{n}{k}.
$$

$(-1)^n$ をくくると
$$
S_n=(-1)^n\sum_{k=0}^{n}\binom{n}{k}\bigl(-(1-\sqrt2)\bigr)^k.
$$

ここで
$$
-(1-\sqrt2)=\sqrt2-1
$$
なので、二項定理より
$$
S_n=(-1)^n(1+\sqrt2-1)^n=(-1)^n(\sqrt2)^n.
$$

したがって不等式
$$
S_n>2^{2021}
$$
は
$$
(-1)^n(\sqrt2)^n>2^{2021}
$$
である。

右辺は正なので、まず $n$ は偶数でなければならない。
偶数 $n$ のとき
$$
(\sqrt2)^n=2^{n/2}>2^{2021}
$$
より
$$
\frac{n}{2}>2021
$$
$$
n>4042.
$$

偶数でこれを満たす最小の $n$ は
$$
\boxed{4044}
$$
である。

### 3. 問題

正の実数 $x,y,z$ が
$$
\frac{1}{x}+\frac{2}{y}+\frac{3}{z}=1
$$
を満たすとき，$(x-1)(y-2)(z-3)$ の最小値を求めよ。

### 3. 解答

次の置換をする。
$$
p=\frac{1}{x},\qquad q=\frac{2}{y},\qquad r=\frac{3}{z}.
$$
（以下で $r=\frac3z$ とする。）

すると条件は
$$
p+q+r=1,
\qquad p,q,r>0.
$$

また
$$
x=\frac1p,\qquad y=\frac2q,\qquad z=\frac3r.
$$
だから
$$
x-1=\frac{1-p}{p},
\qquad y-2=\frac{2(1-q)}{q},
\qquad z-3=\frac{3(1-r)}{r}.
$$

したがって
$$
(x-1)(y-2)(z-3)=6\frac{(1-p)(1-q)(1-r)}{pqr}.
$$

ここで $p+q+r=1$ より
$$
1-p=q+r,
\qquad 1-q=r+p,
\qquad 1-r=p+q.
$$

よって
$$
(x-1)(y-2)(z-3)=6\frac{(q+r)(r+p)(p+q)}{pqr}.
$$

ここで AM-GM（相加相乗平均）より
$$
q+r\ge 2\sqrt{qr},
\qquad r+p\ge 2\sqrt{rp},
\qquad p+q\ge 2\sqrt{pq}.
$$

3式を掛けると
$$
(q+r)(r+p)(p+q)\ge 8pqr.
$$

したがって
$$
(x-1)(y-2)(z-3)\ge 6\cdot \frac{8pqr}{pqr}=48.
$$

等号成立条件は
$$
p=q=r
$$
すなわち
$$
p=q=r=\frac13
$$
のときである。

このとき
$$
x=3,\quad y=6,\quad z=9
$$
となり、実際に
$$
(x-1)(y-2)(z-3)=2\cdot 4\cdot 6=48.
$$

よって最小値は
$$
\boxed{48}
$$
である。

### 4. 問題

座標空間において，各座標が整数である $6$ 個の点 $P_0,P_1,P_2,P_3,P_4,P_5$ を，次の条件を満たすように重複を許して選ぶ。

(i) $P_0=(0,0,0)$  
(ii) $P_k$ と $P_{k+1}$ との距離は $1$（$k=0,1,2,3,4$）  
(iii) $P_0$ と $P_5$ との距離は $1$

このとき，選び方の総数を求めよ。

### 4. 解答

各ステップは格子点間の距離1なので、各回の移動は
$$
(\pm1,0,0),\ (0,\pm1,0),\ (0,0,\pm1)
$$
の6通りである。

条件 (iii) より、5回移動した後の位置は原点から距離1、すなわち
$$
(\pm1,0,0),\ (0,\pm1,0),\ (0,0,\pm1)
$$
の6点のいずれかである。

対称性により、終点を $(1,0,0)$ とする場合の数を求めて6倍すればよい。

#### 終点を $(1,0,0)$ とする場合

$x$ 方向の正負移動回数をそれぞれ $u,v$、$y$ 方向の正負移動回数をそれぞれ $p,p$、$z$ 方向をそれぞれ $q,q$ とおく（$y,z$ は差が0でなければならない）。

すると
$$
u-v=1,
$$
また全移動回数が5なので
$$
u+v+2p+2q=5.
$$

$p,q\ge 0$ で $p+q\le 2$ を満たす場合を調べる。

##### (1) $p=q=0$

このとき
$$
u+v=5,\quad u-v=1
$$
より
$$
u=3,\quad v=2.
$$
並べ方は
$$
\frac{5!}{3!2!}=10.
$$

##### (2) $(p,q)=(1,0)$ または $(0,1)$

このとき
$$
u+v=3,\quad u-v=1
$$
より
$$
u=2,\quad v=1.
$$

例えば $(p,q)=(1,0)$ のとき、種類は
$$
X^+,X^+,X^-,Y^+,Y^-
$$
で、並べ方は
$$
\frac{5!}{2!}=60.
$$

同様に $(0,1)$ でも 60 通り。よって合計
$$
60+60=120.
$$

##### (3) $(p,q)=(2,0)$ または $(0,2)$

このとき
$$
u+v=1,\quad u-v=1
$$
より
$$
u=1,\quad v=0.
$$

例えば $(p,q)=(2,0)$ では種類は
$$
X^+,Y^+,Y^+,Y^-,Y^-
$$
で、並べ方は
$$
\frac{5!}{2!2!}=30.
$$

2通りあるので合計
$$
30+30=60.
$$

##### (4) $(p,q)=(1,1)$

このときも
$$
u=1,\quad v=0.
$$
種類は5種類すべて1個ずつなので並べ方は
$$
5!=120.
$$

#### 合計（終点 $(1,0,0)$）

以上より、終点を $(1,0,0)$ とする場合の数は
$$
10+120+60+120=310.
$$

終点は対称に6通りあるから総数は
$$
310\times 6=1860.
$$

よって
$$
\boxed{1860}
$$
通りである。

## 大問2

### 問題

図のように，1辺の長さが $2$ である立方体 $ABCD-EFGH$ の内側に，正方形 $ABCD$ に内接する円を底面にもつ高さ $2$ の円柱 $V$ をとる。次の設問に答えよ。

1. 立方体の対角線 $AG$ と円柱 $V$ の共通部分として得られる線分の長さを求めよ。
2. $W$ を三角柱 $ABF-DCG$ と三角柱 $AEH-BFG$ の共通部分とする。円柱 $V$ の側面と $W$ の共通部分に含まれる線分の長さの最大値を求めよ。

### 解答

座標を次のようにおく。
$$
A(0,0,0),\ B(2,0,0),\ C(2,2,0),\ D(0,2,0),
$$
$$
E(0,0,2),\ F(2,0,2),\ G(2,2,2),\ H(0,2,2).
$$

このとき円柱 $V$ は
$$
(x-1)^2+(y-1)^2\le 1,
\qquad 0\le z\le 2
$$
で表される。

#### 1. 対角線 $AG$ と円柱の共通部分の長さ

対角線 $AG$ は
$$
(x,y,z)=(2t,2t,2t)\qquad (0\le t\le 1)
$$
と表せる。

これが円柱内にある条件は
$$
(2t-1)^2+(2t-1)^2\le 1
$$
$$
2(2t-1)^2\le 1
$$
$$
|2t-1|\le \frac{1}{\sqrt2}.
$$

よって許される $t$ の範囲の長さは
$$
\frac{1}{\sqrt2}
$$
である（$2t-1$ の幅が $\sqrt2$ なので、$t$ の幅はその半分）。

一方
$$
|AG|=\sqrt{2^2+2^2+2^2}=2\sqrt3.
$$

したがって共通部分の線分の長さは
$$
2\sqrt3\cdot \frac{1}{\sqrt2}=\sqrt6.
$$

よって
$$
\boxed{\sqrt6}
$$
である。

#### 2. 円柱側面と $W$ の共通部分に含まれる線分の最大長

まず、三角柱 $ABF-DCG$ と $AEH-BFG$ を不等式で表す。

- 三角柱 $ABF-DCG$ は（各 $y$ で同じ断面）
  $$
  0\le z\le x\le 2
  $$
- 三角柱 $AEH-BFG$ は（各 $x$ で同じ断面）
  $$
  0\le y\le z\le 2
  $$

したがってその共通部分 $W$ は
$$
0\le y\le z\le x\le 2
$$
である。

次に、円柱の側面は
$$
(x-1)^2+(y-1)^2=1,
\qquad 0\le z\le 2.
$$

ここで、円柱側面上に含まれる直線は円柱の母線（$z$ 軸方向の直線）に限られる。したがって、求める「線分」は $(x,y)$ を固定した鉛直線分である。

円柱側面上の1点 $(x,y)$ を固定すると、$W$ の条件より $z$ は
$$
y\le z\le x
$$
を満たすので、そのとき得られる線分の長さは
$$
L=x-y
$$
である（ただし $y\le x$）。

よって、円
$$
(x-1)^2+(y-1)^2=1
$$
上で $x-y$ を最大化すればよい。

円を
$$
x=1+\cos t,
\qquad y=1+\sin t
$$
とおくと
$$
L=x-y=\cos t-\sin t=\sqrt2\cos\left(t+\frac\pi4\right).
$$

したがって最大値は
$$
\boxed{\sqrt2}
$$
である。

（実際、$t=-\frac\pi4$ のとき達する。）

## 大問3

### 問題

次の設問に答えよ。

1. $225$ のすべての正の約数の和を求めよ。
2. $2021$ 以下の正の整数で，すべての正の約数の和が奇数であるものの個数を求めよ。

### 解答

#### 1. $225$ の約数の和

素因数分解すると
$$
225=3^2\cdot 5^2.
$$

約数和の公式
$$
\sigma(p^e)=1+p+p^2+\cdots+p^e
$$
および積性より
$$
\sigma(225)=\sigma(3^2)\sigma(5^2)
=(1+3+9)(1+5+25).
$$

計算して
$$
1+3+9=13,
\qquad 1+5+25=31,
$$
$$
\sigma(225)=13\cdot 31=403.
$$

よって
$$
\boxed{403}
$$
である。

#### 2. 約数和が奇数である整数の個数

正整数 $n$ を
$$
n=2^e p_1^{a_1}p_2^{a_2}\cdots p_r^{a_r}
$$
（$p_i$ は奇素数）と素因数分解する。

約数和は
$$
\sigma(n)=\sigma(2^e)\prod_{i=1}^{r}\sigma(p_i^{a_i}).
$$

ここで
$$
\sigma(2^e)=1+2+2^2+\cdots+2^e=2^{e+1}-1
$$
は常に奇数である。

一方、奇素数 $p$ に対しては各項が奇数なので
$$
\sigma(p^a)=1+p+\cdots+p^a
$$
の parity（奇偶）は項数 $a+1$ の奇偶に一致する。したがって
$$
\sigma(p^a) \text{ が奇数 }\iff a \text{ は偶数}.
$$

よって
$$
\sigma(n)\text{ が奇数 }\iff 
\text{奇素数の指数 }a_i\text{ がすべて偶数}.
$$

これは
$$
n=2^e m^2 \quad (m\text{ は奇数})
$$
と書けることと同値である。

したがって $n$ は

- 平方数
- または $2\times$ 平方数

のどちらかである（互いに重ならない）。

##### 平方数の個数

$$
44^2=1936\le 2021,
\qquad 45^2=2025>2021
$$
より
$$
44\text{ 個}.
$$

##### $2\times$ 平方数の個数

$$
2m^2\le 2021 \iff m^2\le 1010.5.
$$

$$
31^2=961\le 1010.5,
\qquad 32^2=1024>1010.5
$$
より
$$
31\text{ 個}.
$$

以上より個数は
$$
44+31=75.
$$

よって
$$
\boxed{75}
$$
である。

---

## 最終答案（穴埋め）

大問1  
$$
\boxed{\text{ア}=\frac{1+x}{1-x}},\quad
\boxed{\text{イ}=4044},\quad
\boxed{\text{ウ}=48},\quad
\boxed{\text{エ}=1860}
$$

大問2  
$$
\boxed{\sqrt6},\quad \boxed{\sqrt2}
$$

大問3  
$$
\boxed{403},\quad \boxed{75}
$$

