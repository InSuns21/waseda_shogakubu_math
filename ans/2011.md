# 2011年 早稲田大学 商学部 数学 解答

## 大問1

### 1. 問題
関数
   \[
   f(x)=\int_0^1 |t^2-x^2|\,dt
   \]
   の最小値は \(\boxed{\text{ア}}\) である。

### 1. 解答
\(|x|\) だけで決まるので
\[
u=|x|\quad (u\ge 0)
\]
とおく。

すると
\[
f(x)=\int_0^1 |t^2-u^2|\,dt
\]
である。

#### (i) \(0\le u\le 1\) のとき
\(t=u\) で符号が変わるので
\[
f(x)=\int_0^u (u^2-t^2)\,dt+\int_u^1 (t^2-u^2)\,dt.
\]

各項を計算すると
\[
\int_0^u (u^2-t^2)\,dt
=\left[u^2t-\frac{t^3}{3}\right]_0^u
=u^3-\frac{u^3}{3}
=\frac{2u^3}{3},
\]
\[
\int_u^1 (t^2-u^2)\,dt
=\left[\frac{t^3}{3}-u^2t\right]_u^1
=\left(\frac13-u^2\right)-\left(\frac{u^3}{3}-u^3\right)
\]
\[
=\frac13-u^2+\frac{2u^3}{3}.
\]

したがって
\[
f(x)=\frac13-u^2+\frac{4u^3}{3}. \tag{1}
\]

微分すると
\[
\frac{d}{du}f(x)=-2u+4u^2=2u(2u-1).
\]

よって \(0\le u\le 1\) では \(u=\dfrac12\) で最小。

そのとき
\[
f_{\min}=\frac13-\left(\frac12\right)^2+\frac{4}{3}\left(\frac12\right)^3
\]
\[
=\frac13-\frac14+\frac16
=\frac12-\frac14
=\frac14.
\]

#### (ii) \(u\ge 1\) のとき
このとき \(0\le t\le 1\) では常に \(t^2\le 1\le u^2\) だから
\[
f(x)=\int_0^1 (u^2-t^2)\,dt
=u^2-\frac13\ge 1-\frac13=\frac23>\frac14.
\]

以上より最小値は
\[
\boxed{\frac14}
\]
である。

### 2. 問題
\(n\) を正の整数とする。\((10^n)\) の正の約数すべての積は \(\boxed{\text{イ}}\) である。

### 2. 解答
\[
10^n=2^n5^n
\]
だから、正の約数の個数は
\[
(n+1)(n+1)=(n+1)^2.
\]

正の約数全体を \(d_1,d_2,\ldots,d_{(n+1)^2}\) とすると、各約数 \(d\) に対して
\[
\frac{10^n}{d}
\]
も約数であり、
\[
d\cdot \frac{10^n}{d}=10^n.
\]

したがって約数全体の積は
\[
(10^n)^{(n+1)^2/2}.
\]

よって
\[
\boxed{10^{\frac{n(n+1)^2}{2}}}
\]
である。

### 3. 問題
\(\log_3 n\) が無理数となる \(2011\) 以下の正の整数 \(n\) は，全部で \(\boxed{\text{ウ}}\) 個ある。

### 3. 解答
\(\log_3 n\) が有理数である場合を先に数える。

\[
\log_3 n=\frac{p}{q}\qquad (p\in\mathbb Z,\ q\in\mathbb N)
\]
とする（既約分数）。

すると
\[
n=3^{p/q}
\]
だから
\[
n^q=3^p.
\]

右辺は素因数 \(3\) しかもたないので、左辺 \(n^q\) も素因数 \(3\) しかもたたない。よって \(n\) は
\[
n=3^k \qquad (k\in\mathbb Z_{\ge 0})
\]
の形である。

逆に \(n=3^k\) なら
\[
\log_3 n=k
\]
は有理数である。

したがって、\(\log_3 n\) が有理数であるのは \(n\) が 3 の冪のときに限る。

\[
3^0=1,\ 3^1=3,\ 3^2=9,\ 3^3=27,\ 3^4=81,\ 3^5=243,\ 3^6=729,\ 3^7=2187>2011
\]
より、\(2011\) 以下の 3 の冪は
\[
7\text{ 個}
\]
である。

よって求める個数は
\[
2011-7=2004.
\]

したがって
\[
\boxed{2004}
\]
である。

### 4. 問題
関数 \(f(x)\) は，次の2つの条件を満たしている。  
   (i) すべての実数 \(x\) に対して，\(f(3-x)=f(3+x)\)  
   (ii) この関数 \(f\) の最小値を与える \(x\) の値を \(a_1,a_2,a_3,a_4\)（\(a_1<a_2<a_3<a_4\)）とするときに限り \(f(x)=0\) となる。  
   このとき \(a_1+a_2+a_3+a_4=\boxed{\text{エ}}\) である。

### 4. 解答
条件 (i)
\[
f(3-x)=f(3+x)
\]
は、グラフが直線
\[
x=3
\]
に関して対称であることを意味する。

条件 (ii) より、\(f(x)=0\) となるのはちょうど
\[
x=a_1,a_2,a_3,a_4
\]
の 4 点であり、しかもこれらは最小値を与える点である。

対称性より、\(x=a_i\) が解なら、点 \(x=6-a_i\) でも
\[
f(6-a_i)=f(a_i)=0
\]
となる。

解はちょうど 4 個で、\(a_1<a_2<a_3<a_4\) と並んでいるので、対称な組は
\[
a_1+a_4=6,\qquad a_2+a_3=6
\]
となる。

したがって
\[
a_1+a_2+a_3+a_4=(a_1+a_4)+(a_2+a_3)=6+6=12.
\]

よって
\[
\boxed{12}
\]
である。

### 大問1 最終答案（穴埋め）
- ア：`\dfrac14`
- イ：`10^{\frac{n(n+1)^2}{2}}`
- ウ：`2004`
- エ：`12`

## 大問2

### 問題
原点を \(O\) とする座標空間において，2点 \(A(3,3,4),\ B(1,0,0)\) がある。次の条件を満たす点 \(P\) の集合を \(C\) とする。
\[
|\overrightarrow{AP}|=1,\qquad \overrightarrow{OB}\cdot\overrightarrow{AP}=0
\]
また，次の条件を満たす点 \(Q\) の集合を \(S\) とする。
\[
|\overrightarrow{OQ}|=1
\]
次の設問に答えよ。

1. 点 \(Q\) を \(S\) 上の点とするとき，\(|\overrightarrow{AQ}|\) の最大値と最小値を求めよ。
2. 点 \(P\) を \(C\) 上の点とし，点 \(Q\) を \(S\) 上の点とするとき，\(|\overrightarrow{PQ}|\) の最大値と最小値を求めよ。

### 解答
まず集合 \(C\) の形を調べる。

\[
\overrightarrow{OB}=(1,0,0)
\]
なので
\[
\overrightarrow{OB}\cdot\overrightarrow{AP}=0
\]
は、\(\overrightarrow{AP}\) の \(x\) 成分が 0 であることを意味する。

すなわち、\(P=(x,y,z)\) とすると
\[
x-3=0 \Rightarrow x=3.
\]

また \(|\overrightarrow{AP}|=1\) より、\(C\) は
- 中心 \(A(3,3,4)\)
- 半径 1
- 平面 \(x=3\)

上の円である。

## 1. 解答
集合 \(S\) は原点中心半径 1 の球面である。

点 \(A\) から球面 \(S\) 上の点 \(Q\) までの距離 \(|AQ|\) の最大・最小は、原点 \(O\) と \(A\) を結ぶ直線上で達成される。

\[
|OA|=\sqrt{3^2+3^2+4^2}=\sqrt{34}.
\]

よって
\[
|AQ|_{\min}=|OA|-1=\sqrt{34}-1,
\]
\[
|AQ|_{\max}=|OA|+1=\sqrt{34}+1.
\]

したがって
\[
\boxed{\text{最大値 } \sqrt{34}+1,\ \text{最小値 } \sqrt{34}-1}
\]
である。

## 2. 解答
まず \(|OP|\) のとりうる範囲を求める。

点 \(P\in C\) は平面 \(x=3\) 上にあり、\(A(3,3,4)\) を中心とする半径 1 の円上にあるから、
\[
\overrightarrow{AP}=(0,u,v),\qquad u^2+v^2=1
\]
とおける。

したがって
\[
P=(3,3+u,4+v).
\]

よって
\[
|OP|^2=3^2+(3+u)^2+(4+v)^2
\]
\[
=9+(9+6u+u^2)+(16+8v+v^2)
\]
\[
=34+6u+8v+(u^2+v^2)
=35+6u+8v.
\]

ここで
\[
6u+8v
\]
の最大値・最小値は、\(\sqrt{6^2+8^2}=10\) と \(-10\) である（コーシー・シュワルツの不等式）。

したがって
\[
25\le |OP|^2\le 45
\]
すなわち
\[
5\le |OP|\le 3\sqrt5. \tag{1}
\]

次に、固定した \(P\) に対して \(Q\in S\)（\(|OQ|=1\)）を動かすとき、\(|PQ|\) の最大・最小は
\[
|PQ|_{\max}=|OP|+1,\qquad |PQ|_{\min}=||OP|-1|
\]
である。

(1) より \(|OP|\ge 5>1\) なので
\[
|PQ|_{\min}=|OP|-1.
\]

したがって全体の最大・最小は
\[
|PQ|_{\max}= (3\sqrt5)+1,
\]
\[
|PQ|_{\min}= 5-1=4.
\]

よって
\[
\boxed{\text{最大値 } 3\sqrt5+1,\ \text{最小値 } 4}
\]
である。

### 大問2 最終答案
1. 最大値 `\sqrt{34}+1`，最小値 `\sqrt{34}-1`
2. 最大値 `3\sqrt5+1`，最小値 `4`

## 大問3

### 問題
数列 \(\{a_n\}\) を次のように定める。

(i) \(a_1=0\)

(ii) \(n=2,3,4,\ldots\) に対し，
\[
\begin{cases}
a_n=a_{n-1}-n & (a_{n-1}\ge n\text{ のとき})\\
a_n=a_{n-1}+n & (a_{n-1}<n\text{ のとき})
\end{cases}
\]
とする。

次の設問に答えよ。

1. \(a_7\) を求めよ。
2. \(a_k=k\) のとき，条件
   \[
   m>k,\quad a_m=m
   \]
   を満たす最小の整数 \(m\) を \(k\) で表せ。
3. \(a_{2011}\) を求めよ。

### 解答
### 1. 解答
定義通りに計算する。

\[
a_1=0
\]
\[
a_2=a_1+2=2 \qquad (0<2)
\]
\[
a_3=a_2+3=5 \qquad (2<3)
\]
\[
a_4=a_3-4=1 \qquad (5\ge 4)
\]
\[
a_5=a_4+5=6 \qquad (1<5)
\]
\[
a_6=a_5-6=0 \qquad (6\ge 6)
\]
\[
a_7=a_6+7=7 \qquad (0<7)
\]

よって
\[
\boxed{a_7=7}
\]
である。

### 2. 解答
\(a_k=k\) と仮定する。

このとき、その後の項を順に計算すると

\[
a_{k+1}=a_k+(k+1)=2k+1 \qquad (a_k=k<k+1)
\]

さらに
\[
a_{k+2}=a_{k+1}-(k+2)=(2k+1)-(k+2)=k-1
\]
（\(2k+1\ge k+2\)）。

同様に
\[
a_{k+3}=a_{k+2}+(k+3)=(k-1)+(k+3)=2k+2,
\]
\[
a_{k+4}=a_{k+3}-(k+4)=(2k+2)-(k+4)=k-2.
\]

この形から、\(r=1,2,\ldots,k\) に対して
\[
a_{k+2r-1}=2k+r,\qquad a_{k+2r}=k-r \tag{1}
\]
が成り立つ（数学的帰納法で示せる）。

(1) から \(r=k\) とすると
\[
a_{k+2k}=a_{3k}=k-k=0.
\]

よって次の項は
\[
a_{3k+1}=a_{3k}+(3k+1)=3k+1.
\]

したがって
\[
m=3k+1
\]
は \(a_m=m\) を満たす。

また \(k<n<3k+1\) で \(a_n=n\) が起こらないことを確認する。

- \(n=k+2r\)（偶数ずれ）のとき、(1) より
  \[
  a_n=k-r<n
  \]
  で等しくない。

- \(n=k+2r-1\)（奇数ずれ）のとき、(1) より
  \[
  a_n=2k+r.
  \]
  もし \(a_n=n\) なら
  \[
  2k+r=k+2r-1 \Rightarrow r=k+1
  \]
  となるが、これは \(n=3k+1\) に対応し、\(n<3k+1\) に反する。

よって最小の \(m\) は
\[
\boxed{m=3k+1}
\]
である。

### 3. 解答
1. より \(a_2=2\) である。

2. の結果を繰り返し用いると、\(a_k=k\) を満たす \(k\) は
\[
2,\ 7,\ 22,\ 67,\ 202,\ 607,\ 1822,\ \ldots
\]
となり、漸化式
\[
k_{n+1}=3k_n+1
\]
で与えられる。

ここで
\[
1822<2011<5467
\]
なので、\(k=1822\) から次の固定点 \(5467\) に至る途中にある。

したがって 2. の式 (1) を \(k=1822\) に適用する。

\[
2011-1822=189=2\cdot 95-1
\]
だから
\[
2011=1822+(2\cdot 95-1).
\]

よって (1) の奇数ずれの式から
\[
a_{2011}=2\cdot 1822+95=3644+95=3739.
\]

したがって
\[
\boxed{a_{2011}=3739}
\]
である。

### 大問3 最終答案
1. `a_7=7`
2. `m=3k+1`
3. `a_{2011}=3739`
