# 2023年 早稲田大学 商学部 数学 解答

## 大問1

### 1. 問題

$n\ge 2$ とする。点
$$
P_k=\left(2^{k-1},\ \log_2 2^{k-1}\right)=\left(2^{k-1},k-1\right)\qquad (k=1,2,\ldots,n)
$$
を考える。線分 $P_1P_2,P_2P_3,\ldots,P_{n-1}P_n$ と直線 $x=2^{n-1}$ および $x$ 軸で囲まれる図形の面積を $S(n)$ とする。

$$
\frac{S(n)}{2^n}\ge 2023
$$
を満たす最小の $n$ を求めよ。

### 1. 解答

$P_k=(2^{k-1},k-1)$ なので、$S(n)$ は各区間
$$
[2^{k-1},2^k]\qquad (k=1,2,\ldots,n-1)
$$
の台形の面積の和である。

第 $k$ 区間の台形の面積は
$$
\frac{(k-1)+k}{2}\cdot (2^k-2^{k-1})
$$
$$
=\frac{2k-1}{2}\cdot 2^{k-1}
=2^{k-2}(2k-1).
$$

したがって
$$
S(n)=\sum_{k=1}^{n-1}2^{k-2}(2k-1).
$$

ここで $m=n-1$ とおくと
$$
S(n)=\frac14\sum_{k=1}^{m}(2k-1)2^k
=\frac14\left(2\sum_{k=1}^{m}k2^k-\sum_{k=1}^{m}2^k\right).
$$

公式
$$
\sum_{k=1}^{m}k2^k=(m-1)2^{m+1}+2,\qquad \sum_{k=1}^{m}2^k=2^{m+1}-2
$$
を用いると
$$
S(n)=\frac14\left(2\{(m-1)2^{m+1}+2\}-(2^{m+1}-2)\right)
$$
$$
=\frac14\left((2m-3)2^{m+1}+6\right)
=(2m-3)2^{m-1}+\frac32.
$$

$m=n-1$ に戻して
$$
S(n)=(2n-5)2^{n-2}+\frac32.
$$

よって
$$
\frac{S(n)}{2^n}
=\frac{2n-5}{4}+\frac{3}{2^{n+1}}.
$$

これが $2023$ 以上になる最小の $n$ を求める。

$n=4048$ のとき
$$
\frac{2n-5}{4}=\frac{8091}{4}=2022.75
$$
で、$\dfrac{3}{2^{4049}}<0.25$ だから
$$
\frac{S(4048)}{2^{4048}}<2023.
$$

$n=4049$ のとき
$$
\frac{2n-5}{4}=\frac{8093}{4}=2023.25>2023
$$
より確実に成り立つ。

したがって最小の $n$ は
$$
\boxed{4049}
$$
である。

### 2. 問題

半径 $1$ の円に内接する三角形 $\triangle ABC$ が
$$
\sin A=\frac{m}{17},\qquad \sin B=\frac{n}{17},\qquad \sin^2C=\sin^2A+\sin^2B
$$
を満たすとき、内接円の半径を求めよ（$m,n$ は正の整数）。

### 2. 解答

まず
$$
C=\pi-(A+B)
$$
より
$$
\sin^2C=\sin^2(A+B).
$$

条件から
$$
\sin^2(A+B)=\sin^2A+\sin^2B.
$$

左辺を展開して整理すると
$$
\sin(A+B)=\sin A\cos B+\cos A\sin B
$$
なので
$$
\sin^2(A+B)=\sin^2A\cos^2B+\sin^2B\cos^2A+2\sin A\sin B\cos A\cos B.
$$

これが $\sin^2A+\sin^2B$ に等しいから
$$
2\sin A\sin B(\cos A\cos B-\sin A\sin B)=0.
$$

$A,B$ は三角形の角で $\sin A,\sin B>0$ なので
$$
\cos A\cos B-\sin A\sin B=0
$$
$$
\cos(A+B)=0.
$$

したがって
$$
A+B=\frac{\pi}{2}\qquad \Rightarrow\qquad C=\frac{\pi}{2}.
$$

よって
$$
\sin C=1.
$$

また条件 $\sin^2C=\sin^2A+\sin^2B$ から
$$
1=\left(\frac{m}{17}\right)^2+\left(\frac{n}{17}\right)^2
$$
$$
m^2+n^2=17^2.
$$

正の整数解は
$$
(m,n)=(8,15)\ \text{または}\ (15,8)
$$
のみ。

半径1の外接円をもつ三角形なので、辺長は
$$
a=2\sin A,\quad b=2\sin B,\quad c=2\sin C=2.
$$

したがって直角三角形の2辺は
$$
\frac{16}{17},\ \frac{30}{17}
$$
（順不同）、斜辺は $2$。

直角三角形の内接円半径 $r$ は
$$
r=\frac{(\text{2辺の和})-(\text{斜辺})}{2}
$$
だから
$$
r=\frac{\frac{16}{17}+\frac{30}{17}-2}{2}
=\frac{\frac{46}{17}-\frac{34}{17}}{2}
=\frac{12/17}{2}
=\frac{6}{17}.
$$

よって
$$
\boxed{\frac{6}{17}}
$$
である。

### 3. 問題

次の条件 (i), (ii), (iii) を満たす $n$ 次関数 $f(x)$ のうち、$n$ が最小のものを求めよ。

(i) $f(1)=2$

(ii)
$$
\int_{-1}^{1}(x+1)f(x)\,dx=0
$$

(iii) すべての正の整数 $m$ に対して
$$
\int_{-1}^{1}|x|^m f(x)\,dx=0
$$

### 3. 解答

$f$ の偶関数部分・奇関数部分を
$$
f(x)=g(x)+h(x)
$$
（$g$ は偶関数、$h$ は奇関数）
とする。

条件 (iii) で $|x|^m$ は偶関数なので、積分に寄与するのは偶関数部分 $g$ のみである。したがって
$$
\int_{-1}^{1}|x|^m g(x)\,dx=0\qquad (m=1,2,3,\ldots).
$$

$g$ は偶多項式だから、$g$ が 0 でないとするとその次数を $d$ として
$$
g(x)=c_0+c_2x^2+\cdots+c_d x^d
$$
と書ける。

ここで $d=2n$ とおく（$g$ は偶多項式なので次数は偶数）。

条件
$$
\int_{-1}^{1}|x|^m g(x)\,dx=0
$$
を奇数 $m=2r+1$（$r=0,1,2,\ldots,n$）について用いると、偶関数であることから
$$
0=2\int_0^1 x^{2r+1}g(x)\,dx.
$$

ここで置換
$$
t=x^2\qquad (dt=2x\,dx)
$$
を用いると
$$
\int_0^1 x^{2r+1}g(x)\,dx
=\frac12\int_0^1 t^r\bigl(c_0+c_2t+\cdots+c_{2n}t^n\bigr)\,dt.
$$

$$
h(t)=c_0+c_2t+\cdots+c_{2n}t^n
$$
とおけば、
$$
\int_0^1 t^r h(t)\,dt=0\qquad (r=0,1,2,\ldots,n).
$$

特に、上の等式を $r=0,1,\ldots,n$ についてそれぞれ係数 $c_{2r}$ 倍して足し合わせると
$$
\int_0^1 h(t)\{c_0+c_2t+\cdots+c_{2n}t^n\}\,dt=0,
$$
すなわち
$$
\int_0^1 h(t)^2\,dt=0.
$$

$h(t)^2\ge 0$ であり、その積分が 0 だから
$$
h(t)\equiv 0\quad (0\le t\le 1).
$$
多項式が区間上で恒等的に 0 なら係数はすべて 0 なので
$$
c_0=c_2=\cdots=c_{2n}=0.
$$
よって
$$
g\equiv 0.
$$

したがって
$$
f(x)\ \text{は奇関数}
$$
である。

#### 条件 (ii) の利用

$f$ が奇関数なので
$$
\int_{-1}^{1}f(x)\,dx=0.
$$

よって (ii) は
$$
\int_{-1}^{1}x f(x)\,dx=0
$$
と同値。

最小次数を考える。

- 1次奇関数なら $f(x)=cx$。
  条件 (i) より $c=2$、すなわち $f(x)=2x$。
  しかし
  $$
  \int_{-1}^{1}x f(x)\,dx=\int_{-1}^{1}2x^2\,dx=\frac{4}{3}\ne 0
  $$
  で不適。

したがって最小次数は少なくとも 3。

3次奇関数を
$$
f(x)=ax^3+bx
$$
とおく。

条件 (i) より
$$
a+b=2.
$$

条件 (ii) より
$$
\int_{-1}^{1}x(ax^3+bx)\,dx=0
$$
$$
a\int_{-1}^{1}x^4\,dx+b\int_{-1}^{1}x^2\,dx=0
$$
$$
a\cdot \frac{2}{5}+b\cdot \frac{2}{3}=0.
$$

両辺を $\dfrac12$ 倍して
$$
\frac{a}{5}+\frac{b}{3}=0
$$
$$
3a+5b=0.
$$

連立
$$
a+b=2,\qquad 3a+5b=0
$$
を解くと
$$
a=-5,\qquad b=7.
$$

よって最小次数の関数は
$$
\boxed{f(x)=-5x^3+7x}
$$
である。

### 4. 問題

1回の操作で、サイコロを3回振って出た目を $3$ で割った余り $(r_1,r_2,r_3)$ を座標空間の点として定める。これを3回行い、得られた点を順に $A_1,A_2,A_3$ とする。$A_1,A_2,A_3$ が正三角形の異なる3頂点となる確率を求めよ。

### 4. 解答

各余り $0,1,2$ はそれぞれ確率 $\dfrac13$ で出るので、1回の操作で得られる点は
$$
\{0,1,2\}^3
$$
の 27 点上で一様である。

したがって $(A_1,A_2,A_3)$ は 27 点からの独立な一様選択であり、全事象の数（順序つき）は
$$
27^3=19683.
$$

よって、正三角形になる順序つき組の個数を数えればよい。

#### 正三角形の辺長の分類（格子点）

2点間の各座標差は $-2,-1,0,1,2$ のいずれかなので、距離の2乗は整数である。

実際に正三角形になりうる辺長の2乗は
$$
2,\ 6,\ 8
$$
の3種類に限られる（格子差ベクトルの型の分類）。

以下、辺長の2乗ごとに数える（無順序）。

##### (i) 辺長の2乗が 2 の場合

これは各辺が「1×1 正方形の対角線」になる場合である。

このタイプの正三角形は、各 1×1×1 小立方体の8頂点のうち、偶奇（座標和の偶奇）で分かれる2つの正四面体の面として現れる。

1つの小立方体につき

- 正四面体が 2 個
- それぞれの面が 4 枚

だから正三角形は
$$
2\times 4=8\ \text{個}.
$$

小立方体は
$$
2\times 2\times 2=8\ \text{個}
$$
あるので、このタイプは
$$
8\times 8=64\ \text{個}.
$$

##### (ii) 辺長の2乗が 8 の場合

これは全体の 2×2×2 立方体（頂点は 8 個）の中で、辺長 $2\sqrt2$ の正三角形になる場合である。

上と同じく、8頂点は2つの正四面体に分かれ、その各面が正三角形になる。

したがって個数は
$$
2\times 4=8\ \text{個}.
$$

##### (iii) 辺長の2乗が 6 の場合

この場合の正三角形の頂点は、全体の立方体の「辺の中点」に対応する 12 点（座標のうちちょうど1つが 1）に限られる。

代表として $A=(0,0,1)$ を固定して考えると、$A$ から距離の2乗が 6 である点は
$$
(1,2,0),\ (1,2,2),\ (2,1,0),\ (2,1,2)
$$
の4点である。

このうち $A$ とともに正三角形を作るのは
$$
\{(1,2,0),(2,1,2)\},\qquad \{(1,2,2),(2,1,0)\}
$$
の2組だけである。

したがって、各辺の中点はこのタイプの正三角形に 2 個ずつ属する。

辺の中点は 12 個あるから、無順序の正三角形の個数は
$$
\frac{12\times 2}{3}=8.
$$

##### 合計（無順序）

以上より、無順序の正三角形の総数は
$$
64+8+8=80.
$$

#### 順序つき組に直す

正三角形の異なる3頂点を順に $(A_1,A_2,A_3)$ とする順序つきの取り方は、各三角形につき
$$
3!=6
$$
通り。

したがって有利な順序つき組は
$$
80\times 6=480.
$$

よって求める確率は
$$
\frac{480}{19683}
=\frac{160}{6561}.
$$

したがって
$$
\boxed{\frac{160}{6561}}
$$
である。

## 大問2

### 問題

中心 $O$、半径 1 の球に内接する四面体で、頂点 $T_1,T_2,T_3,T_4$ が

$$
|T_1T_2|=\sqrt3,
$$
$$
k(\overrightarrow{OT_1}+\overrightarrow{OT_2})+\overrightarrow{OT_3}+\overrightarrow{OT_4}=\vec 0
$$

を満たす（$0<k<2$）。次の設問に答えよ。

1. $T_3T_4$ の中点を $M$ としたとき、$\triangle T_1T_2M$ の面積を $k$ で表せ。
2. 条件を満たす四面体の体積の最大値を $V(k)$ とする。$V(k)$ が最大となるときの $k$ を求めよ。

### 解答

$$
\mathbf u_i=\overrightarrow{OT_i}\qquad (i=1,2,3,4)
$$
とおく。各点は単位球上にあるので
$$
|\mathbf u_i|=1.
$$

また
$$
|T_1T_2|^2=|\mathbf u_1-\mathbf u_2|^2
=|\mathbf u_1|^2+|\mathbf u_2|^2-2\mathbf u_1\cdot\mathbf u_2
$$
より
$$
3=2-2\mathbf u_1\cdot\mathbf u_2
$$
$$
\mathbf u_1\cdot\mathbf u_2=-\frac12.
$$

したがって
$$
\mathbf s=\mathbf u_1+\mathbf u_2,\qquad \mathbf d=\mathbf u_1-\mathbf u_2
$$
とおくと
$$
|\mathbf s|^2=|\mathbf u_1|^2+|\mathbf u_2|^2+2\mathbf u_1\cdot\mathbf u_2=2-1=1,
$$
$$
|\mathbf d|^2=|\mathbf u_1|^2+|\mathbf u_2|^2-2\mathbf u_1\cdot\mathbf u_2=2+1=3,
$$
また
$$
\mathbf s\cdot \mathbf d=|\mathbf u_1|^2-|\mathbf u_2|^2=0.
$$

#### 1. $\triangle T_1T_2M$ の面積

$M$ は $T_3T_4$ の中点なので
$$
\overrightarrow{OM}=\frac{\mathbf u_3+\mathbf u_4}{2}.
$$

条件 (ii) より
$$
\mathbf u_3+\mathbf u_4=-k(\mathbf u_1+\mathbf u_2)=-k\mathbf s
$$
だから
$$
\overrightarrow{OM}=-\frac{k}{2}\mathbf s.
$$

また、$T_1T_2$ の中点 $N$ は
$$
\overrightarrow{ON}=\frac{\mathbf u_1+\mathbf u_2}{2}=\frac12\mathbf s.
$$

よって
$$
\overrightarrow{NM}=\overrightarrow{OM}-\overrightarrow{ON}
=-\frac{k+1}{2}\mathbf s.
$$

一方
$$
\overrightarrow{T_1T_2}=\mathbf u_2-\mathbf u_1=-\mathbf d.
$$

$\mathbf s\perp \mathbf d$ なので、$NM\perp T_1T_2$。したがって $\triangle T_1T_2M$ の高さは
$$
|NM|=\frac{k+1}{2}|\mathbf s|=\frac{k+1}{2}.
$$

底辺は
$$
|T_1T_2|=\sqrt3.
$$

よって面積は
$$
\frac12\cdot \sqrt3\cdot \frac{k+1}{2}
=\frac{\sqrt3}{4}(k+1).
$$

したがって
$$
\boxed{\frac{\sqrt3}{4}(k+1)}
$$
である。

#### 2. 体積最大のときの $k$

$$
\mathbf m=\frac{\mathbf u_3+\mathbf u_4}{2}=-\frac{k}{2}\mathbf s
$$
とおき、
$$
\mathbf w=\frac{\mathbf u_3-\mathbf u_4}{2}
$$
とおくと
$$
\mathbf u_3=\mathbf m+\mathbf w,\qquad \mathbf u_4=\mathbf m-\mathbf w.
$$

ここで
$$
|\mathbf u_3|=|\mathbf u_4|=1
$$
より
$$
|\mathbf m+\mathbf w|^2=|\mathbf m-\mathbf w|^2
$$
を引き算して
$$
\mathbf m\cdot \mathbf w=0.
$$

さらに
$$
|\mathbf m+\mathbf w|^2=1
$$
から
$$
|\mathbf w|^2=1-|\mathbf m|^2.
$$

$|\mathbf s|=1$ より
$$
|\mathbf m|=\frac{k}{2},
$$
したがって
$$
|\mathbf w|=\sqrt{1-\frac{k^2}{4}}.
$$

四面体 $T_1T_2T_3T_4$ の体積を、底面を $\triangle T_1T_2M$ とみて求める。

$M$ は $T_3T_4$ の中点なので、$T_3,T_4$ は平面 $T_1T_2M$ に関して同じ距離だけ反対側にある。したがって四面体は
$$
V=\frac13\cdot (\triangle T_1T_2M\text{ の面積})\cdot (2h)
$$
と表せる。ただし $h$ は点 $T_3$ から平面 $T_1T_2M$ までの距離。

1. より
$$
\triangle T_1T_2M\text{ の面積}=\frac{\sqrt3}{4}(k+1).
$$

また
$$
\overrightarrow{MT_3}=\mathbf w,\qquad \overrightarrow{MT_4}=-\mathbf w
$$
である。

平面 $T_1T_2M$ は、$\overrightarrow{T_1T_2}=-\mathbf d$ と $\overrightarrow{NM}\parallel \mathbf s$ を含むので、$\mathbf d,\mathbf s$ の張る平面である。

よって $h$ は $\mathbf w$ の「平面 $(\mathbf d,\mathbf s)$ に垂直な成分の長さ」であり、
$$
h\le |\mathbf w|=\sqrt{1-\frac{k^2}{4}}.
$$
等号は $\mathbf w\perp \mathbf d$ のとき成立する（すでに $\mathbf w\perp \mathbf s$ は示してある）。

以上より
$$
V(k)\le \frac13\cdot \frac{\sqrt3}{4}(k+1)\cdot 2\sqrt{1-\frac{k^2}{4}}
=\frac{\sqrt3}{6}(k+1)\sqrt{1-\frac{k^2}{4}}.
$$
$$
=\frac{\sqrt3}{12}(k+1)\sqrt{4-k^2}.
$$
しかも等号は実現可能なので、
$$
V(k)=\frac{\sqrt3}{12}(k+1)\sqrt{4-k^2}.
$$

したがって $V(k)$ の最大化は
$$
(k+1)^2(4-k^2)
$$
の最大化と同値。

微分すると
$$
\frac{d}{dk}\{(k+1)^2(4-k^2)\}
=2(k+1)(4-k^2)+(k+1)^2(-2k)
$$
$$
=2(k+1)(4-2k^2-k).
$$

$0<k<2$ で $k+1>0$ だから
$$
4-2k^2-k=0
$$
を解けばよい。

$$
2k^2+k-4=0
$$
より
$$
k=\frac{-1\pm \sqrt{33}}{4}.
$$

$0<k<2$ を満たすのは
$$
\boxed{\frac{\sqrt{33}-1}{4}}
$$
のみ。

よって
$$
\boxed{k=\frac{\sqrt{33}-1}{4}}
$$
である。

## 大問3

### 問題

正の整数 $n$ について、$n^2+n+1$ が

1. $7$ で割り切れるような $n$ を小さい順に並べたときの 100 番目
2. $91$ で割り切れるような $n$ を小さい順に並べたときの 100 番目

を求めよ。

### 解答

#### 1. $n^2+n+1\equiv 0\pmod 7$

$\bmod 7$ で調べると
$$
n=2,\ 4
$$
で
$$
n^2+n+1\equiv 0\pmod 7
$$
となる。

したがって解は
$$
n\equiv 2,\ 4\pmod 7
$$
である。

小さい順に並べると
$$
2,4,\ 9,11,\ 16,18,\ldots
$$
で、1ブロック（長さ7）ごとに2個ずつ現れる。

100 番目は、50 ブロック目（$m=49$）の2個目なので
$$
n=4+7\cdot 49=347.
$$

よって
$$
\boxed{347}
$$
である。

#### 2. $n^2+n+1\equiv 0\pmod{91}$

$$
91=7\cdot 13
$$
であり、$7$ と $13$ は互いに素である。

したがって、$\bmod 91$ の解は

- $\bmod 7$ での解の並び
- $\bmod 13$ での解の並び

を 1 から 91 までの範囲で重ね合わせて調べればよい。

まず $\bmod 7$ では
$$
n\equiv 2,\ 4\pmod 7.
$$

次に $\bmod 13$ で調べると
$$
n\equiv 3,\ 9\pmod{13}
$$
である（小さい順に並べると
$$
3,9,\ 16,22,\ 29,35,\ldots
$$
のように現れる）。

実際に
$$
n^2+n+1\equiv 0\pmod{13}
$$
となる。

一方、$\bmod 7$ の解は
$$
2,4,\ 9,11,\ 16,18,\ldots
$$
のように現れる（つまり $n\equiv 2,4\pmod 7$）。

そこで 1 から 91 までで両方に共通なものを探すと
$$
n\equiv 9,\ 16,\ 74,\ 81\pmod{91}.
$$

よって小さい順では、1ブロック（長さ91）ごとに4個ずつ現れる。

100 番目は
$$
100=4\times 25
$$
より、25ブロック目（$m=24$）の4個目にあたる。

したがって
$$
n=81+91\cdot 24.
$$

計算して
$$
91\cdot 24=2184,\qquad 2184+81=2265.
$$

よって
$$
\boxed{2265}
$$
である。

---

## 最終答案（穴埋め）

大問1  
$$
\boxed{\text{ア}=4049},\quad
\boxed{\text{イ}=\frac{6}{17}},\quad
\boxed{\text{ウ}=-5x^3+7x},\quad
\boxed{\text{エ}=\frac{160}{6561}}
$$

大問2  
$$
\boxed{\triangle T_1T_2M\text{ の面積 }=\frac{\sqrt3}{4}(k+1)},\quad
\boxed{k=\frac{\sqrt{33}-1}{4}}
$$

大問3  
$$
\boxed{347},\quad \boxed{2265}
$$
