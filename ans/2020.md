# 2020年 早稲田大学 商学部 数学 解答

## 大問1

### 1. 問題

$m,n$ を正の整数とする。$n$ 次関数 $f(x)$ が次の等式を満たしているとき，$f(x)$ を求めよ。

$$
\int_0^x (x-t)^{m-1}f(t)\,dt=\{f(x)\}^m
$$

### 1. 解答

$f(x)$ の次数を $n$（$n\ge 1$）とする。

左辺の次数を考える。

- $(x-t)^{m-1}$ の $x$ に関する寄与は次数 $m-1$
- $f(t)$ は $t$ の $n$ 次式
- $t$ で積分すると $x$ の次数はさらに $1$ 増える

したがって左辺の次数は
$$
n+m.
$$

右辺 $\{f(x)\}^m$ の次数は
$$
mn.
$$

よって次数比較より
$$
mn=n+m
$$
$$
mn-n-m=0
$$
$$
(m-1)(n-1)=1.
$$

$m,n$ は正の整数だから
$$
\boxed{m=2,\ n=2}
$$
である。

よって
$$
f(x)=ax^2+bx+c\qquad (a\ne 0)
$$
とおける。

与式に $m=2$ を代入すると
$$
\int_0^x (x-t)f(t)\,dt=\{f(x)\}^2.
$$

左辺を計算する。
$$
\int_0^x (x-t)(at^2+bt+c)\,dt
$$
$$
=\int_0^x \{axt^2+ bxt+cx-at^3-bt^2-ct\}\,dt
$$
$$
=a\left(\frac{x\cdot x^3}{3}-\frac{x^4}{4}\right)+b\left(\frac{x\cdot x^2}{2}-\frac{x^3}{3}\right)+c\left(x\cdot x-\frac{x^2}{2}\right)
$$
$$
=\frac{a}{12}x^4+\frac{b}{6}x^3+\frac{c}{2}x^2.
$$

右辺は
$$
(ax^2+bx+c)^2
$$
$$
=a^2x^4+2abx^3+(b^2+2ac)x^2+2bcx+c^2.
$$

係数比較すると

- $x^4$ の係数：
  $$
  \frac{a}{12}=a^2
  $$
  $a\ne 0$ より
  $$
  a=\frac{1}{12}.
  $$

- $x^3$ の係数：
  $$
  \frac{b}{6}=2ab
  $$
  これは $a=\frac1{12}$ で自動的に成り立つ。

- $x^2$ の係数：
  $$
  \frac{c}{2}=b^2+2ac=b^2+\frac{c}{6}
  $$
  よって
  $$
  \frac{c}{3}=b^2.
  $$

- $x$ の係数：
  $$
  0=2bc.
  $$

- 定数項：
  $$
  0=c^2
  $$
  よって
  $$
  c=0.
  $$

すると $\dfrac{c}{3}=b^2$ より
$$
b=0.
$$

したがって
$$
\boxed{f(x)=\frac{x^2}{12}}
$$
である。

### 2. 問題

整数 $a,b,c,d$ は次の条件 (i), (ii), (iii) を満たしている。

(i) $3\le a<b<c<d$  
(ii) $a-d,\ b-c$ は $3$ の倍数  
(iii) $c^a-b^d$ は $3$ の倍数ではない

このとき，$a+b+c+d$ の最小値を求めよ。

### 2. 解答

条件 (ii) より
$$
a\equiv d\pmod 3,
\qquad b\equiv c\pmod 3.
$$

条件 (iii) を $\bmod 3$ で考える。

#### まず $b,c$ の $\bmod 3$ を調べる

$b\equiv c\pmod 3$ なので、$b^d$ と $c^a$ は同じ底のべきとして考えられる。

- もし $b\equiv c\equiv 0\pmod 3$ なら
  $$
  c^a-b^d\equiv 0-0\equiv 0\pmod 3
  $$
  で条件 (iii) に反する。

- もし $b\equiv c\equiv 1\pmod 3$ なら
  $$
  c^a-b^d\equiv 1-1\equiv 0\pmod 3
  $$
  で条件 (iii) に反する。

したがって
$$
b\equiv c\equiv 2\pmod 3.
$$

よって、$a<b<c<d$ と $a\ge 3$ を用いると、最小の候補は
$$
b\ge 5,
\qquad c\ge 8.
$$

#### 次に $a,d$ の条件

$b\equiv c\equiv 2\pmod 3$ より
$$
c^a-b^d\equiv 2^a-2^d\pmod 3.
$$

$2\equiv -1\pmod 3$ なので
$$
2^n\equiv
\begin{cases}
1 & (n\text{ が偶数})\\
2 & (n\text{ が奇数})
\end{cases}
\pmod 3.
$$

したがって
$$
2^a-2^d\not\equiv 0\pmod 3
$$
となるためには、$a,d$ の偶奇が異なる必要がある。

さらに条件 (ii) より
$$
a\equiv d\pmod 3.
$$

#### 最小化

まず最小の $b,c$ として
$$
b=5,\ c=8
$$
をとる。

このとき $a<5$ かつ $a\ge 3$ より
$$
a=3\ \text{または}\ 4.
$$

- $a=3$ のとき：$d\equiv 0\pmod 3$ かつ $d>8$、さらに偶奇は $a$ と異なる（$d$ は偶数）より
  $$
  d=12
  $$
  が最小。
  このとき和は
  $$
  3+5+8+12=28.
  $$

- $a=4$ のとき：$d\equiv 1\pmod 3$ かつ $d>8$、さらに $d$ は奇数より最小は
  $$
  d=13
  $$
  で和は
  $$
  4+5+8+13=30.
  $$

したがって最小値は $28$ である。

実際、$(a,b,c,d)=(3,5,8,12)$ では
$$
8^3-5^{12}\equiv 2^3-2^{12}\equiv 2-1\equiv 1\not\equiv 0\pmod 3
$$
となり条件を満たす。

よって
$$
\boxed{28}
$$
である。

### 3. 問題

次の条件 (i), (ii) を満たす実数 $\theta$ と数列 $\{a_n\}$ を考える。

(i) $0<\theta<\dfrac{\pi}{2},\ a_1=\tan\theta,\ a_{2020}=0$  
(ii) すべての正の整数 $n$ に対して，$a_n\ne \dfrac{1}{\tan\theta}$ で，
$$
a_{n+1}=\frac{\tan\theta+a_n}{1-a_n\tan\theta}
$$

このとき，$\theta$ の最小値を求めよ。

### 3. 解答

加法定理
$$
\tan(X+Y)=\frac{\tan X+\tan Y}{1-\tan X\tan Y}
$$
を用いる。

与えられた漸化式は
$$
a_{n+1}=\tan(\theta+\arctan a_n)
$$
の形である。

条件 (ii) により分母が0にならないので、帰納法で
$$
a_n=\tan(n\theta)
$$
が成り立つ。

実際、$n=1$ では $a_1=\tan\theta$。また $a_n=\tan(n\theta)$ とすると
$$
a_{n+1}=\frac{\tan\theta+\tan(n\theta)}{1-\tan\theta\tan(n\theta)}
=\tan((n+1)\theta).
$$

したがって条件 $a_{2020}=0$ より
$$
\tan(2020\theta)=0
$$
であり、
$$
2020\theta=m\pi\qquad (m\in\mathbb{Z}_{>0}).
$$

よって
$$
\theta=\frac{m\pi}{2020}.
$$

さらに $0<\theta<\dfrac\pi2$ より
$$
1\le m\le 1009.
$$

#### 条件 (ii) の $a_n\ne \cot\theta$ を使う

$a_n=\tan(n\theta)$ だから
$$
a_n\ne \cot\theta=\tan\left(\frac\pi2-\theta\right)
$$
は
$$
\tan(n\theta)\ne \tan\left(\frac\pi2-\theta\right)
$$
と同値である。したがって
$$
n\theta\ne \frac\pi2-\theta + k\pi\qquad (k\in\mathbb{Z})
$$
すなわち
$$
(n+1)\theta\ne \frac\pi2+k\pi
$$
がすべての正整数 $n$ で成り立つ必要がある。

ここで $\theta=\dfrac{m\pi}{2020}$ を代入すると
$$
\frac{(n+1)m\pi}{2020}\ne \frac\pi2+k\pi
$$
$$
(n+1)m\ne 1010+2020k.
$$

よって、どの正整数 $n$ に対しても
$$
(n+1)m\not\equiv 1010\pmod{2020}
$$
でなければならない。

この合同式 $mr\equiv 1010\pmod{2020}$（$r=n+1$）が解をもつ条件は
$$
\gcd(m,2020)\mid 1010
$$
である。

$$
2020=2^2\cdot 5\cdot 101,
\qquad 1010=2\cdot 5\cdot 101
$$
なので、解が存在しないためには
$$
\gcd(m,2020)
$$
が $4$ を因数にもつことが必要十分である。

最小の正整数 $m$ でこれを満たすのは
$$
m=4.
$$

したがって $\theta$ の最小値は
$$
\theta=\frac{4\pi}{2020}=\frac{\pi}{505}.
$$

よって
$$
\boxed{\frac{\pi}{505}}
$$
である。

### 4. 問題

四面体 $OABC$ において，$\cos\angle AOB=\dfrac{1}{5},\ \cos\angle AOC=-\dfrac{1}{3}$ であり，面 $OAB$ と面 $OAC$ のなす角は $\dfrac{\pi}{2}$ である。このとき，$\cos\angle BOC$ を求めよ。

### 4. 解答

点 $O$ を原点とし，
$$
\mathbf{u}=\frac{\overrightarrow{OA}}{|OA|},\quad
\mathbf{b}=\frac{\overrightarrow{OB}}{|OB|},\quad
\mathbf{c}=\frac{\overrightarrow{OC}}{|OC|}
$$
を単位ベクトルとする。

すると
$$
\mathbf{u}\cdot\mathbf{b}=\cos\angle AOB=\frac15,
\qquad
\mathbf{u}\cdot\mathbf{c}=\cos\angle AOC=-\frac13.
$$

ここで、$\mathbf{b},\mathbf{c}$ を $\mathbf{u}$ 方向成分と垂直成分に分解する。
$$
\mathbf{b}=\left(\mathbf{u}\cdot\mathbf{b}\right)\mathbf{u}+\mathbf{b}_\perp,
\qquad
\mathbf{c}=\left(\mathbf{u}\cdot\mathbf{c}\right)\mathbf{u}+\mathbf{c}_\perp.
$$

面 $OAB$ と面 $OAC$ のなす角は、共通辺 $OA$ に垂直な成分 $\mathbf{b}_\perp,\mathbf{c}_\perp$ のなす角に等しい。これが $\dfrac\pi2$ なので
$$
\mathbf{b}_\perp\cdot\mathbf{c}_\perp=0.
$$

したがって
$$
\mathbf{b}\cdot\mathbf{c}
=\left(\mathbf{u}\cdot\mathbf{b}\right)\left(\mathbf{u}\cdot\mathbf{c}\right)+\mathbf{b}_\perp\cdot\mathbf{c}_\perp
=\frac15\cdot\left(-\frac13\right)+0
=-\frac{1}{15}.
$$

ところで
$$
\mathbf{b}\cdot\mathbf{c}=\cos\angle BOC
$$
だから
$$
\boxed{-\frac{1}{15}}
$$
である。

## 大問2

### 問題

$a,b$ を実数とし，$x$ の2次関数 $f(x),g(x)$ を
$$
f(x)=x^2+ax+b,\qquad g(x)=4x(1-x)
$$
とする。次の設問に答えよ。

1. $g(x)=x$ となる $x$ の値をすべて求めよ。
2. 次の条件 $(*)$ を満たす $f(x)$ をすべて求めよ。

$(*)$ $0<\alpha<\dfrac{1}{2}$ である実数 $\alpha$ が存在して，$0$ 以上のすべての整数 $n$ に対して，$f(g^n(\alpha))=g^n(\alpha)$ となる。

ただし，$g^0(\alpha)=\alpha,\ g^{n+1}(\alpha)=g(g^n(\alpha))$（$n=0,1,2,\ldots$）とする。

### 解答

#### 1. $g(x)=x$ の解

$$
4x(1-x)=x
$$
$$
4x-4x^2=x
$$
$$
3x-4x^2=0
$$
$$
x(3-4x)=0.
$$

よって
$$
\boxed{x=0,\ \frac34}
$$
である。

#### 2. 条件 $(*)$ を満たす $f(x)$

条件 $(*)$ は、数列
$$
\alpha,\ g(\alpha),\ g^2(\alpha),\ \ldots
$$
のすべての項が方程式
$$
f(x)=x
$$
の解であることを意味する。

ここで
$$
h(x)=f(x)-x=x^2+(a-1)x+b
$$
とおくと、$h(x)$ は2次式である。したがってその実数解は高々2個である。

よって、軌道集合
$$
\{g^n(\alpha)\mid n=0,1,2,\ldots\}
$$
は高々2個の値しかとれない。

以下、可能性を分類する。

##### (A) ある時点で固定点 $\frac34$ に入る場合

$0<\alpha<\frac12$ なので、固定点 $0$ には最初からいない。
また $g(x)=0$ の解は $x=0,1$ なので、$0<\alpha<\frac12$ から有限回で $0$ に入ることもない。

したがって固定点に入るなら $\frac34$ である。

軌道が高々2個であるためには
$$
g(\alpha)=\frac34
$$
でなければならない（それより前の段階が増えると3個以上になる）。

これを解くと
$$
4\alpha(1-\alpha)=\frac34
$$
$$
16\alpha^2-16\alpha+3=0
$$
$$
(4\alpha-1)(4\alpha-3)=0.
$$

$0<\alpha<\frac12$ より
$$
\alpha=\frac14.
$$

このとき軌道は
$$
\left\{\frac14,\frac34\right\}
$$
なので、$h(x)$ の根はこの2点である。

したがって
$$
h(x)=\left(x-\frac14\right)\left(x-\frac34\right)=x^2-x+\frac{3}{16}.
$$
よって
$$
f(x)=h(x)+x=x^2+\frac{3}{16}.
$$

##### (B) 2周期点（$g(g(\alpha))=\alpha$, $g(\alpha)\ne \alpha$）の場合

このとき軌道が2個で閉じるので条件に合う。

まず
$$
g(g(x))=x
$$
を解く。

$$
g(x)=4x-4x^2
$$
より
$$
g(g(x))=4(4x-4x^2)-4(4x-4x^2)^2
$$
$$
=16x-16x^2-4(16x^2-32x^3+16x^4)
$$
$$
=16x-80x^2+128x^3-64x^4.
$$

したがって
$$
g(g(x))-x=-64x^4+128x^3-80x^2+15x.
$$
因数分解すると
$$
g(g(x))-x=x(4x-3)(16x^2-20x+5).
$$

固定点 $x=0,\frac34$ を除いた2周期点は
$$
16x^2-20x+5=0
$$
の解である。

よって2つの値は
$$
\alpha=\frac{5-\sqrt5}{8},\qquad \beta=\frac{5+\sqrt5}{8}
$$
であり、確かに
$$
0<\alpha<\frac12
$$
を満たす。

このとき $h(x)$ の根は $\alpha,\beta$ だから
$$
h(x)=(x-\alpha)(x-\beta)=x^2-(\alpha+\beta)x+\alpha\beta.
$$

ここで
$$
\alpha+\beta=\frac{20}{16}=\frac54,
\qquad
\alpha\beta=\frac{5}{16}
$$
より
$$
h(x)=x^2-\frac54x+\frac{5}{16}.
$$

したがって
$$
f(x)=h(x)+x=x^2-\frac14x+\frac{5}{16}.
$$

以上より、求める $f(x)$ は
$$
\boxed{f(x)=x^2+\frac{3}{16}},
\qquad
\boxed{f(x)=x^2-\frac14x+\frac{5}{16}}
$$
の2つである。

## 大問3

### 問題

$\{x_n\}$ を数列とする。$1\le k\le l$ である整数 $k,l$ に対して，$\{x_n\}$ の第 $k$ 項から第 $l$ 項までの平均
$$
\frac{1}{l-k+1}\sum_{i=k}^{l}x_i
$$
を，$m(k,l)$ と表す。

数列 $\{x_n\}$ に対して，次の条件 $(*)$ を満たす $1$ 以上 $100$ 以下の整数 $t$ 全体の集合を $S(\{x_n\})$ とする。

$(*)$ $1\le k\le t$ であるすべての整数 $k$ に対して，$m(k,t)\ge 40$

次の設問に答えよ。

1. 数列 $\{x_n\}$ が，すべての正の整数 $n$ に対して，$x_n=n$ であるとき，$S(\{x_n\})$ の要素の個数を求めよ。
2. $1\le k\le l\le 100$ である整数 $k,l$ が，次の条件 (i), (ii) を満たすとする。  
   (i) $k\ne 1$ のとき，$k-1\in S(\{x_n\})$  
   (ii) $k\le j\le l$ であるすべての整数 $j$ に対し，$j\notin S(\{x_n\})$
   
   このとき，$m(k,l)<40$ であることを示せ。
3. 数列 $\{x_n\}$ が，すべての正の整数 $n$ に対して，$0\le x_n\le 100$ であり，$m(1,100)\ge 50$ であるとき，$S(\{x_n\})$ の要素の個数の最小値を求めよ。

### 解答

#### 準備：偏差和で言い換える

$$
s_t=\sum_{i=1}^{t}(x_i-40)\qquad (t=1,2,\ldots,100),
\qquad s_0=0
$$
とおく。

すると
$$
m(k,t)\ge 40
$$
は
$$
\frac{1}{t-k+1}\sum_{i=k}^{t}x_i\ge 40
$$
$$
\iff \sum_{i=k}^{t}(x_i-40)\ge 0
$$
$$
\iff s_t-s_{k-1}\ge 0.
$$

よって
$$
t\in S(\{x_n\})
$$
であることは
$$
s_t\ge s_0,s_1,\ldots,s_{t-1}
$$
と同値である。つまり、$S(\{x_n\})$ は偏差和列 $\{s_t\}$ の「それまでの最大値を更新する時刻（同値を含む）」の集合である。

#### 1. $x_n=n$ のとき

このとき
$$
m(k,t)=\frac{k+t}{2}
$$
（等差数列の平均）である。

$t\in S$ であるためには、すべての $1\le k\le t$ に対して $\dfrac{k+t}{2}\ge 40$ が必要。
左辺は $k$ が最小のとき最小なので、$k=1$ を見れば十分である。

したがって
$$
\frac{1+t}{2}\ge 40
$$
$$
1+t\ge 80
$$
$$
t\ge 79.
$$

$t$ は $1\le t\le 100$ なので、個数は
$$
100-79+1=22.
$$

よって
$$
\boxed{22}
$$
である。

#### 2. $m(k,l)<40$ を示す

条件 (i) より（$k\ne 1$ の場合）
$$
k-1\in S
$$
であるから、準備の言い換えより
$$
s_{k-1}\ge s_0,s_1,\ldots,s_{k-2}
$$
すなわち $s_{k-1}$ は時刻 $k-1$ までの最大値である。

また条件 (ii) より $k\le j\le l$ のすべての $j$ は $S$ に属さないので、各 $j$ について
$$
s_j < \max\{s_0,s_1,\ldots,s_{j-1}\}.
$$
特に $s_{k-1}$ はその最大値候補の1つなので
$$
s_j < s_{k-1}\qquad (k\le j\le l)
$$
が成り立つ。

とくに $j=l$ とすると
$$
s_l<s_{k-1}.
$$
よって
$$
s_l-s_{k-1}<0.
$$

これは
$$
\sum_{i=k}^{l}(x_i-40)<0
$$
と同値であり、したがって
$$
\frac{1}{l-k+1}\sum_{i=k}^{l}x_i<40.
$$

すなわち
$$
\boxed{m(k,l)<40}
$$
が示された。

（$k=1$ の場合も同様に $s_0=0$ を基準に同じ議論ができる。）

#### 3. $|S(\{x_n\})|$ の最小値

求める集合を簡単に $S$ と書き、その要素数を $r$ とする。

##### 下界（$r\ge 17$）

$S=\{t_1<t_2<\cdots<t_r\}$ とする。

$S$ に入らない時刻が続く区間を
- $[1,t_1-1]$（空でもよい）
- $[t_1+1,t_2-1],\ldots,[t_{r-1}+1,t_r-1]$
- $[t_r+1,100]$

と分ける。

これらの各非空区間について、2. の結果より、その区間の平均は $40$ 未満、すなわち
$$
\sum (x_i-40)<0
$$
である。

したがって全体の偏差和は
$$
s_{100}=\sum_{i=1}^{100}(x_i-40)
$$
について
$$
s_{100}<\sum_{t\in S}(x_t-40).
$$

ここで $0\le x_t\le 100$ より
$$
x_t-40\le 60
$$
だから
$$
\sum_{t\in S}(x_t-40)\le 60r.
$$

ゆえに
$$
s_{100}<60r.
$$

一方、条件 $m(1,100)\ge 50$ より
$$
\frac{1}{100}\sum_{i=1}^{100}x_i\ge 50
$$
$$
\sum_{i=1}^{100}(x_i-40)\ge 100\cdot (50-40)=1000.
$$
つまり
$$
s_{100}\ge 1000.
$$

以上を合わせて
$$
1000\le s_{100}<60r.
$$
したがって
$$
r>\frac{1000}{60}=\frac{50}{3}
$$
より
$$
r\ge 17.
$$

##### 構成（$r=17$ が実現可能）

次の数列をとる。

$$
x_1=x_2=\cdots=x_{83}=40-\frac{20}{83},
$$
$$
x_{84}=x_{85}=\cdots=x_{100}=100.
$$

このとき確かに $0\le x_n\le 100$ を満たす。

全体平均を確認する。
$$
\sum_{i=1}^{100}(x_i-40)=83\left(-\frac{20}{83}\right)+17\cdot 60=-20+1020=1000.
$$
よって
$$
m(1,100)=40+\frac{1000}{100}=50.
$$

次に $S$ を調べる。

- $t\le 83$ のとき
  $$
  m(1,t)=40-\frac{20}{83}<40
  $$
  なので $t\notin S$。

- $t\ge 84$ のとき、任意の $1\le k\le t$ に対して平均が $40$ 以上であることを示す。
  偏差和で言えば
  $$
  \sum_{i=k}^{t}(x_i-40)\ge 0
  $$
  を示せばよい。

  - $k\ge 84$ のとき：各項は $60$ なので明らかに正。
  - $k\le 83$ のとき：最悪なのは $t=84, k=1$ のときで
    $$
    \sum_{i=1}^{84}(x_i-40)=-20+60=40>0.
    $$
    より一般の場合も正。

したがって
$$
84,85,\ldots,100\in S
$$
であり、他は入らないから
$$
|S|=17.
$$

以上より最小値は
$$
\boxed{17}
$$
である。

---

## 最終答案（穴埋め）

大問1  
$$
\boxed{\text{ア}=\frac{x^2}{12}},\quad
\boxed{\text{イ}=28},\quad
\boxed{\text{ウ}=\frac{\pi}{505}},\quad
\boxed{\text{エ}=-\frac{1}{15}}
$$

大問2  
$$
\boxed{x=0,\ \frac34},
$$
$$
\boxed{f(x)=x^2+\frac{3}{16}},\quad \boxed{f(x)=x^2-\frac14x+\frac{5}{16}}
$$

大問3  
$$
\boxed{|S(\{x_n\})|=22},\quad \boxed{m(k,l)<40},\quad \boxed{\min |S(\{x_n\})|=17}
$$
