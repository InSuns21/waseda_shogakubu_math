# 2015年 早稲田大学 商学部 数学 解答

## 大問1

### 1. 問題
数列 \(\{a_n\}\) は，次の条件 (i)，(ii) を満たす。  
   (i) \(a_1=0,\ a_n\le 0\ (n=2,3,4,\ldots)\)  
   (ii) \[
   n=\int_{a_n}^{a_{n+1}}\left(x+\frac12\right)\,dx\qquad (n=1,2,3,\ldots)
   \]
   \(n=2,3,4,\ldots\) のとき，\(a_n=\boxed{\text{ア}}\) である。

### 1. 解答
条件 (ii) を計算する。

\[
\int \left(x+\frac12\right)dx=\frac{x^2}{2}+\frac{x}{2}
\]
だから
\[
n=\left[\frac{x^2}{2}+\frac{x}{2}\right]_{a_n}^{a_{n+1}}
=\frac{a_{n+1}^2+a_{n+1}-a_n^2-a_n}{2}.
\]

よって
\[
a_{n+1}^2+a_{n+1}-(a_n^2+a_n)=2n.
\]

ここで
\[
b_n=a_n^2+a_n
\]
とおくと
\[
b_{n+1}-b_n=2n.
\]

また \(a_1=0\) より
\[
b_1=0.
\]

したがって
\[
b_n=\sum_{k=1}^{n-1}2k
=n(n-1).
\]

すなわち
\[
a_n^2+a_n=n(n-1).
\]

これを解くと
\[
a_n=\frac{-1\pm \sqrt{1+4n(n-1)}}{2}
\]
\[
=\frac{-1\pm (2n-1)}{2}
\]
なので
\[
a_n=n-1 \quad \text{または}\quad a_n=-n.
\]

条件 (i) より \(n\ge 2\) では \(a_n\le 0\) だから
\[
a_n=-n.
\]

よって
\[
\boxed{-n}
\]

である（\(n=2,3,4,\ldots\)）。

### 2. 問題
\[
   \sum_{k=1}^{7}\log_2\cos\frac{k\pi}{16}=\boxed{\text{イ}}
\]

### 2. 解答
対数の和を積に直す。

\[
\sum_{k=1}^{7}\log_2\cos\frac{k\pi}{16}
=\log_2\left(\prod_{k=1}^{7}\cos\frac{k\pi}{16}\right).
\]

ここで
\[
\cos\frac{k\pi}{16}=\sin\left(\frac{\pi}{2}-\frac{k\pi}{16}\right)
=\sin\frac{(8-k)\pi}{16}
\]
より
\[
\prod_{k=1}^{7}\cos\frac{k\pi}{16}
=\prod_{j=1}^{7}\sin\frac{j\pi}{16}. \tag{1}
\]

（使用する公式）
\[
\prod_{j=1}^{n-1}\sin\frac{j\pi}{n}=\frac{n}{2^{n-1}}
\]
を \(n=16\) に適用すると
\[
\prod_{j=1}^{15}\sin\frac{j\pi}{16}=\frac{16}{2^{15}}=\frac{1}{2^{11}}.
\]

左辺を \(j\) と \(16-j\) で組にすると
\[
\sin\frac{8\pi}{16}=1
\]
なので
\[
\left(\prod_{j=1}^{7}\sin\frac{j\pi}{16}\right)^2=\frac{1}{2^{11}}.
\]

よって
\[
\prod_{j=1}^{7}\sin\frac{j\pi}{16}=2^{-11/2}
\]
（各項正なので正の平方根）。

(1) より
\[
\prod_{k=1}^{7}\cos\frac{k\pi}{16}=2^{-11/2}.
\]

したがって
\[
\sum_{k=1}^{7}\log_2\cos\frac{k\pi}{16}
=\log_2\left(2^{-11/2}\right)
=-\frac{11}{2}.
\]

よって
\[
\boxed{-\frac{11}{2}}
\]

である。

### 3. 問題
実数 \(x,y\) が，\(|x|+|y|=1\) を満たしているとき，
   \[
   |7x-3y|+|5x-11y|
   \]
   の最大値は \(\boxed{\text{ウ}}\) である。

### 3. 解答
三角不等式より
\[
|7x-3y|\le 7|x|+3|y|,
\qquad
|5x-11y|\le 5|x|+11|y|.
\]

したがって
\[
|7x-3y|+|5x-11y|
\le (7|x|+3|y|)+(5|x|+11|y|)
\]
\[
=12|x|+14|y|
\le 14(|x|+|y|)=14.
\]

よって最大値は高々 \(14\)。

一方、\(x=0,\ y=1\) とすると
\[
|x|+|y|=1
\]
であり
\[
|7x-3y|+|5x-11y|
=|-3|+|-11|
=14.
\]

したがって最大値は
\[
\boxed{14}
\]
である。

### 4. 問題
関数 \(f(x)=1-2|x|\) を考える。次の条件 (i)，(ii) を満たす実数 \(a\) は全部で \(\boxed{\text{エ}}\) 個ある。  
   (i) \(f(a)\ne a\)  
   (ii) \(f(f(f(a)))=a\)

### 4. 解答
\[
f(x)=1-2|x|
\]
は区分線形関数である。\(a,\ f(a),\ f^2(a)\) の符号をそれぞれ
\[
\varepsilon_0,\varepsilon_1,\varepsilon_2\in\{1,-1\}
\]
（\(\varepsilon_i=1\) は非負、\(\varepsilon_i=-1\) は負）とする。

その区間では
\[
f(x)=1-2\varepsilon x
\]
と書けるので、合成すると
\[
f^3(a)=1-2\varepsilon_2+4\varepsilon_2\varepsilon_1-8\varepsilon_2\varepsilon_1\varepsilon_0\,a.
\]

条件 \(f^3(a)=a\) より
\[
a=\frac{1-2\varepsilon_2+4\varepsilon_2\varepsilon_1}{1+8\varepsilon_2\varepsilon_1\varepsilon_0}.
\]

\((\varepsilon_0,\varepsilon_1,\varepsilon_2)\) の 8 通りを調べると、実際に成立する解は次の 8 個である。

\[
a=-1,\ -\frac59,\ -\frac37,\ -\frac19,\ \frac17,\ \frac13,\ \frac57,\ \frac79.
\]

このうち固定点 \(f(a)=a\) を満たすものは
\[
a=-1,\ \frac13
\]
の 2 個である。

よって条件 (i) \(f(a)\ne a\) を満たすのは
\[
8-2=6
\]
個。

したがって
\[
\boxed{6}
\]

である。

### 大問1 最終答案（穴埋め）
- ア：`-n`
- イ：`-\dfrac{11}{2}`
- ウ：`14`
- エ：`6`

## 大問2

### 問題
座標平面上に \(3\) 点 \(O(0,0),\ A(4,0),\ B(0,3)\) がある。実数 \(a,b\) に対し，点 \(P(4a,3b)\)，点 \(Q(4a-4,3b)\)，点 \(R(4a,3b-3)\) をとる。三角形 \(PQR\) と三角形 \(OAB\) の共通部分が六角形となるとき，六角形の面積を \(S\) とする。次の設問に答えよ。

1. \(S\) を \(a,b\) を用いて表せ。
2. \(S\) を最大とする \(a,b\) の値と，そのときの \(S\) の値を求めよ。

### 解答
三角形 \(OAB\) は
\[
\frac{x}{4}+\frac{y}{3}\le 1,\qquad x\ge 0,\ y\ge 0
\]
で表され、面積は
\[
[OAB]=\frac{1}{2}\cdot 4\cdot 3=6.
\]

また \(PQR\) の辺 \(QR\) は \(AB\) に平行で、その方程式は
\[
\frac{x}{4}+\frac{y}{3}=a+b-1
\]
である。

共通部分が六角形であるためには、3 本の切断線
\[
x=4a,\qquad y=3b,\qquad \frac{x}{4}+\frac{y}{3}=a+b-1
\]
が三角形 \(OAB\) の 3 つの頂点付近をそれぞれ切る必要があるので
\[
0<a<1,\qquad 0<b<1,\qquad a+b>1 \tag{条件}
\]
となる。

このとき共通部分の六角形は、三角形 \(OAB\) から次の 3 つの小三角形を除いたものになる。

1. 頂点 \(A\) 側（直線 \(x=4a\) で切られる部分）  
   相似比 \(1-a\) より面積
   \[
   6(1-a)^2
   \]
2. 頂点 \(B\) 側（直線 \(y=3b\) で切られる部分）  
   相似比 \(1-b\) より面積
   \[
   6(1-b)^2
   \]
3. 頂点 \(O\) 側（直線 \(\frac{x}{4}+\frac{y}{3}=a+b-1\) で切られる部分）  
   相似比 \(a+b-1\) より面積
   \[
   6(a+b-1)^2
   \]

よって
\[
S=6-6(1-a)^2-6(1-b)^2-6(a+b-1)^2.
\]

したがって
\[
\boxed{S=6\{1-(1-a)^2-(1-b)^2-(a+b-1)^2\}}.
\]

（展開形）
\[
S=-12a^2-12b^2-12ab+24a+24b-12.
\]

### 2. 解答
\[
p=1-a,\quad q=1-b,\quad r=a+b-1
\]
とおくと、(条件) より
\[
p>0,\ q>0,\ r>0,\qquad p+q+r=1.
\]

また 1. の式は
\[
S=6(1-p^2-q^2-r^2).
\]

ここで
\[
(p+q+r)^2\le 3(p^2+q^2+r^2)
\]
（相加平均・相乗平均、または二乗和の基本不等式）より
\[
1\le 3(p^2+q^2+r^2),
\]
すなわち
\[
p^2+q^2+r^2\ge \frac13.
\]

したがって
\[
S\le 6\left(1-\frac13\right)=4.
\]

等号成立は
\[
p=q=r=\frac13
\]
のとき。よって
\[
1-a=\frac13,\qquad 1-b=\frac13
\]
より
\[
a=b=\frac23.
\]

そのとき
\[
S_{\max}=4.
\]

したがって
\[
\boxed{a=b=\frac23,\quad S=4}
\]

である。

### 大問2 最終答案
1. `S=6\{1-(1-a)^2-(1-b)^2-(a+b-1)^2\}`
2. `a=b=\dfrac23,\ S=4`

## 大問3

### 問題
整数 \(n\) に対し，整数 \(f(n)\) が次の条件 (i)，(ii)，(iii) を満たすように定義されている。

(i) \(f(2015)=0\)

(ii) すべての整数 \(n\) に対して，
\[
f(f(n)+4)=n
\]

(iii) すべての整数 \(n\) に対して，
\[
f(2n)<f(2n+2)
\]

次の設問に答えよ。

1. \(f(4)\) を求めよ。
2. 整数 \(n\) に対し，\(f(4n+1)\) を求めよ。

### 解答
まず (ii) から、\(f\) は単射であることに注意する。

実際、\(f(u)=f(v)\) とすると
\[
f(f(u)+4)=f(f(v)+4)
\]
より (ii) を用いて
\[
u=v.
\]

### 1. 解答
(i) \(f(2015)=0\) を (ii) に代入して
\[
f(f(2015)+4)=2015
\]
\[
f(0+4)=2015
\]
\[
f(4)=2015.
\]

したがって
\[
\boxed{2015}
\]
である。

### 2. 解答
まず、(ii) と単射を使って \(f\) の形を順に決める。

#### ステップ1：\(4n\) 型と \(4n+3\) 型
まず (ii) に \(n=0\) を入れると
\[
f(f(0)+4)=0.
\]
一方 (i) より \(f(2015)=0\)。\(f\) は単射なので
\[
f(0)+4=2015
\]
となり、
\[
f(0)=2011.
\]

同様に
\[
f(f(2011)+4)=2011=f(0)
\]
より単射性から
\[
f(2011)+4=0
\]
すなわち
\[
f(2011)=-4.
\]

この操作を前後に繰り返すと（(ii) と単射性だけで 4 ずつ進む／戻る）、
すべての整数 \(n\) に対して
\[
f(4n)=4n+2011,\qquad f(4n+3)=4n-2012 \tag{1}
\]
が得られる。

（確認）\(n=0\) で \(f(0)=2011\)、\(n=503\) で \(f(2015)=0\) を含む。

#### ステップ2：\(4n+2\) 型
(iii) より、偶数入力では単調増加だから
\[
f(4n)<f(4n+2)<f(4n+4).
\]

(1) を用いると
\[
4n+2011<f(4n+2)<4n+2015.
\]

したがって整数値として
\[
f(4n+2)\in\{4n+2012,\ 4n+2013,\ 4n+2014\}.
\]

これを順に除く。

- \(f(4n+2)=4n+2012\) とすると、(ii) より
  \[
  f(4n+2016)=4n+2.
  \]
  しかし \(4n+2016\) は \(4\) の倍数なので、(1) より
  \[
  f(4n+2016)=4n+4027
  \]
  となり矛盾。

- \(f(4n+2)=4n+2014\) とすると、(ii) より
  \[
  f(4n+2018)=4n+2.
  \]
  ここで \(4n+2<4n+2018\) はともに偶数入力なので (iii) から
  \[
  f(4n+2)<f(4n+2018)
  \]
  でなければならないが、仮定より
  \[
  4n+2014<4n+2
  \]
  となって矛盾。

よって残るのは
\[
f(4n+2)=4n+2013 \tag{2}
\]
のみ。

#### ステップ3：\(4n+1\) 型
(ii) に (2) を代入する。
\[
f(f(4n+2)+4)=4n+2
\]
\[
f(4n+2013+4)=4n+2
\]
\[
f(4n+2017)=4n+2.
\]

ここで \(4n+2017=4(n+504)+1\) なので、\(m=n+504\) とおくと
\[
f(4m+1)=4m-2014.
\]

\(m\) は任意の整数だから、改めて文字を \(n\) に戻せば
\[
\boxed{f(4n+1)=4n-2014}.
\]

### 大問3 最終答案
1. `2015`
2. `f(4n+1)=4n-2014`
