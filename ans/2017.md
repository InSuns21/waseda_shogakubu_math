# 2017年 早稲田大学 商学部 数学 解答

## 大問1

### 1. 問題

\(xy\) 平面において，関数
\[
y=f(x)=\frac{1}{2}\int_{x-1}^{x+1}\bigl||t|-1\bigr|\,dt
\]
のグラフと直線 \(y=1\) で囲まれた部分の面積を求めよ。

### 1. 解答

まず
$$
g(t)=||t|-1|
$$
とおくと、\(g(t)\) は偶関数である。したがって
$$
f(x)=\frac12\int_{x-1}^{x+1}g(t)\,dt
$$
も偶関数である。

よって面積は左右対称であるから、\(x\ge 0\) で求めて2倍すればよい。

#### \(0\le x\le 1\) のとき

このとき区間 \([x-1,x+1]\) は \([-1,0,1]\) をまたぐ。

各区間で
$$
g(t)=
\begin{cases}
1+t & (-1\le t\le 0),\\
1-t & (0\le t\le 1),\\
t-1 & (1\le t)
\end{cases}
$$
であるから、
$$
\int_{x-1}^{x+1}g(t)\,dt
=\int_{x-1}^{0}(1+t)\,dt+\int_0^1(1-t)\,dt+\int_1^{x+1}(t-1)\,dt.
$$

順に計算すると
$$
\int_{x-1}^{0}(1+t)\,dt
=\left[t+\frac{t^2}{2}\right]_{x-1}^{0}
=\frac12-\frac{x^2}{2},
$$
$$
\int_0^1(1-t)\,dt=\frac12,
$$
$$
\int_1^{x+1}(t-1)\,dt
=\left[\frac{(t-1)^2}{2}\right]_1^{x+1}
=\frac{x^2}{2}.
$$

したがって
$$
\int_{x-1}^{x+1}g(t)\,dt=1
$$
より
$$
f(x)=\frac12\qquad (0\le x\le 1).
$$

#### \(1\le x\le 2\) のとき

このとき区間 \([x-1,x+1]\) では \(0,1\) をまたぐので
$$
\int_{x-1}^{x+1}g(t)\,dt
=\int_{x-1}^{1}(1-t)\,dt+\int_{1}^{x+1}(t-1)\,dt.
$$

計算すると
$$
\int_{x-1}^{1}(1-t)\,dt
=\left[t-\frac{t^2}{2}\right]_{x-1}^{1}
=2-2x+\frac{x^2}{2},
$$
$$
\int_{1}^{x+1}(t-1)\,dt=\frac{x^2}{2}.
$$

よって
$$
\int_{x-1}^{x+1}g(t)\,dt=2-2x+x^2
$$
なので
$$
f(x)=\frac{x^2}{2}-x+1\qquad (1\le x\le 2).
$$

#### \(x\ge 2\) のとき

区間 \([x-1,x+1]\) はすべて \(1\) 以上なので \(g(t)=t-1\)。よって
$$
f(x)=\frac12\int_{x-1}^{x+1}(t-1)\,dt=x-1.
$$

以上より、\(f(x)\le 1\) となるのは \(-2\le x\le 2\) で、交点は \(x=\pm 2\) である。

したがって求める面積 \(A\) は
$$
A=2\left\{\int_0^1\left(1-\frac12\right)dx+\int_1^2\left(1-\left(\frac{x^2}{2}-x+1\right)\right)dx\right\}.
$$

整理して
$$
A=2\left\{\int_0^1\frac12\,dx+\int_1^2\left(x-\frac{x^2}{2}\right)dx\right\}.
$$

各積分を計算すると
$$
\int_0^1\frac12\,dx=\frac12,
$$
$$
\int_1^2\left(x-\frac{x^2}{2}\right)dx
=\left[\frac{x^2}{2}-\frac{x^3}{6}\right]_1^2
=\frac{1}{3}.
$$

よって
$$
A=2\left(\frac12+\frac13\right)=2\cdot \frac56=\frac53.
$$

したがって
$$
\boxed{\frac53}
$$
である。

### 2. 問題

\(a,b,c\) は整数とする。4次方程式
\[
x^4+ax^3+bx^2+cx+3=0
\]
の実数解が \(1\) と \(3\) となるような \(a\) の最大値と最小値を求めよ。

### 2. 解答

実数解として \(x=1,3\) をもつので、多項式は
$$
(x-1)(x-3)
$$
を因数にもつ。

したがって
$$
x^4+ax^3+bx^2+cx+3=(x-1)(x-3)(x^2+ux+v)
$$
と表せる（\(u,v\) は整数）。

定数項を比較すると
$$
(-1)(-3)v=3
$$
より
$$
3v=3\quad\Rightarrow\quad v=1.
$$

よって
$$
x^4+ax^3+bx^2+cx+3=(x-1)(x-3)(x^2+ux+1).
$$

\((x-1)(x-3)=x^2-4x+3\) だから
$$
(x^2-4x+3)(x^2+ux+1)
$$
の \(x^3\) の係数は
$$
u-4.
$$

したがって
$$
a=u-4.
$$

ここで「実数解が \(1\) と \(3\)」であるためには、二次式 \(x^2+ux+1\) が

1. 実数解をもたない  
または
2. 実数解が \(1\) のみ（重解）である

のどちらかでなければならない。

#### (i) 実数解をもたない場合

判別式
$$
u^2-4<0
$$
より
$$
u=-1,0,1.
$$

#### (ii) 実数解が \(1\) のみ（重解）の場合

$$
x^2+ux+1=(x-1)^2=x^2-2x+1
$$
より
$$
u=-2.
$$

（\(x=3\) が重解になる場合は \(x^2+ux+1=(x-3)^2\) となる必要があるが、定数項が \(9\) となり不可能。）

よって可能な \(u\) は
$$
u\in\{-2,-1,0,1\}.
$$

したがって
$$
a=u-4\in\{-6,-5,-4,-3\}.
$$

よって
$$
\boxed{\text{最大値 }-3,\ \text{最小値 }-6}
$$
である。

### 3. 問題

三角形 \(ABC\) において，\(AB=3,\ BC=4,\ CA=5\) である。三角形 \(ABC\) の内部の点 \(O\) から線分 \(AB\) に下ろした垂線と線分 \(AB\) との交点を \(P\)，点 \(O\) から線分 \(BC\) に下ろした垂線と線分 \(BC\) との交点を \(Q\)，点 \(O\) から線分 \(CA\) に下ろした垂線と線分 \(CA\) との交点を \(R\) とする。\(OP^2+OQ^2+OR^2\) が最小となるとき，\(OR\) を求めよ。

### 3. 解答

三角形 \(ABC\) は
$$
3^2+4^2=5^2
$$
より直角三角形である。

面積は
$$
[ABC]=\frac12\cdot 3\cdot 4=6.
$$

ここで
$$
x=OQ\ (\text{辺 }BC\text{ への距離}),\quad
y=OR\ (\text{辺 }CA\text{ への距離}),\quad
z=OP\ (\text{辺 }AB\text{ への距離})
$$
とおく。

点 \(O\) は三角形内部にあるので、面積分割より
$$
[ABC]=[OBC]+[OCA]+[OAB].
$$

したがって
$$
6=\frac12\cdot BC\cdot x+\frac12\cdot CA\cdot y+\frac12\cdot AB\cdot z
$$
$$
=\frac12(4x+5y+3z).
$$

よって
$$
4x+5y+3z=12.
$$

求めたい量は
$$
OP^2+OQ^2+OR^2=x^2+y^2+z^2
$$
の最小値である。

ここで Cauchy-Schwarz の不等式（または \((4,5,3)\) への射影）を用いると
$$
(x^2+y^2+z^2)(4^2+5^2+3^2)\ge (4x+5y+3z)^2.
$$

よって
$$
(x^2+y^2+z^2)\cdot (16+25+9)\ge 12^2
$$
$$
50(x^2+y^2+z^2)\ge 144.
$$

等号成立条件は
$$
(x,y,z)\parallel (4,5,3)
$$
すなわち
$$
x:y:z=4:5:3
$$
である。

したがって最小となるとき
$$
x=4\lambda,\quad y=5\lambda,\quad z=3\lambda
$$
とおける。

これを \(4x+5y+3z=12\) に代入すると
$$
4(4\lambda)+5(5\lambda)+3(3\lambda)=12
$$
$$
(16+25+9)\lambda=12
$$
$$
50\lambda=12
$$
$$
\lambda=\frac{6}{25}.
$$

よって
$$
OR=y=5\lambda=5\cdot \frac{6}{25}=\frac65.
$$

したがって
$$
\boxed{\frac65}
$$
である。

### 4. 問題

実数 \(a,b\) に対し，\(\max\{a,b\}\) を次のように定める。

\(a\ge b\) のとき，\(\max\{a,b\}=a\)  
\(a<b\) のとき，\(\max\{a,b\}=b\)

次の条件 \((*)\) を満たす整数 \(k\) の最大値を求めよ。
\[
(*)\ \text{すべての整数 }n\text{ に対して，}\max\{10^{-k}2^n,\ 10^{100}3^{-n}\}\ge 1
\]
ただし，\(0.301<\log_{10}2<0.3011,\ 0.4771<\log_{10}3<0.4772\) である。

### 4. 解答

条件 \((*)\) は、すべての整数 \(n\) に対して
$$
10^{-k}2^n\ge 1\quad \text{または}\quad 10^{100}3^{-n}\ge 1
$$
が成り立つことを意味する。

#### まず \(k\le 63\) を示す

\(n=210\) を代入して考える。

与えられた条件より
$$
\log_{10}3>0.4771
$$
なので
$$
210\log_{10}3>210\times 0.4771=100.191>100.
$$

よって
$$
10^{100}3^{-210}<1.
$$

したがって \((*)\) が成り立つには
$$
10^{-k}2^{210}\ge 1
$$
が必要である。

これは
$$
k\le 210\log_{10}2
$$
と同値であり、\(\log_{10}2<0.3011\) より
$$
k<210\times 0.3011=63.231.
$$

\(k\) は整数だから
$$
k\le 63.
$$

#### 次に \(k=63\) が実際に成り立つことを示す

任意の整数 \(n\) について、場合分けする。

##### (i) \(n\ge 210\) のとき

\(\log_{10}2>0.301\) より
$$
n\log_{10}2\ge 210\log_{10}2>210\times 0.301=63.21>63.
$$

したがって
$$
10^{-63}2^n>1.
$$

##### (ii) \(n\le 209\) のとき

\(\log_{10}3<0.4772\) より
$$
n\log_{10}3\le 209\log_{10}3<209\times 0.4772=99.7148<100.
$$

したがって
$$
10^{100}3^{-n}>1.
$$

以上より、すべての整数 \(n\) に対して
$$
\max\{10^{-63}2^n,\ 10^{100}3^{-n}\}\ge 1
$$
が成り立つ。

よって最大の整数 \(k\) は
$$
\boxed{63}
$$
である。

## 大問2

### 問題

正の整数 \(n\) に対して，\(p_n=[\sqrt[3]{n}]\) とする。ただし，実数 \(x\) に対し，\([x]\) は \(x\) 以下の最大の整数を表す。例えば，\([1.5]=1,\ [3]=3\) である。次の設問に答えよ。

1. \([\sqrt[3]{n}]=2\) となる正の整数 \(n\) で，\(4\) の倍数であるものをすべて求めよ。
2. \(10^6\) 以下の正の整数 \(n\) で，\(p_n^2\) の倍数であるものの個数を求めよ。
3. 正の整数 \(n\) に対して，整数 \(q_n\) を
   
   \(n\) が \(p_n^2\) の倍数でないとき \(0\)，  
   \(n\) が \(p_n^2\) の倍数であるとき，\(n\) を \(p_n(p_n+1)\) で割ったときの余り
   
   と定義する。
   \[
   S=\sum_{n=1}^{10^6}q_n=q_1+q_2+q_3+\cdots+q_{10^6}
   \]
   を求めよ。

### 解答

#### 1. \([\sqrt[3]{n}]=2\) かつ \(4\) の倍数

\([\sqrt[3]{n}]=2\) であることは
$$
2\le \sqrt[3]{n}<3
$$
と同値だから
$$
8\le n<27.
$$

この範囲の \(4\) の倍数は
$$
8,\ 12,\ 16,\ 20,\ 24.
$$

したがって
$$
\boxed{8,\ 12,\ 16,\ 20,\ 24}
$$
である。

#### 2. \(p_n^2\) の倍数である \(n\) の個数

\(p_n=m\) とすると
$$
m\le \sqrt[3]{n}<m+1
$$
より
$$
m^3\le n<(m+1)^3.
$$

\(10^6=100^3\) なので、\(m\) は
$$
1\le m\le 100
$$
である。

##### \(1\le m\le 99\) のとき

\(n\) が \(p_n^2=m^2\) の倍数であるとすると
$$
n=m^2t\quad (t\in \mathbb{Z}_{>0})
$$
と書ける。

条件 \(m^3\le n<(m+1)^3\) は
$$
m^3\le m^2t<(m+1)^3
$$
$$
m\le t<\frac{(m+1)^3}{m^2}
=m+3+\frac{3}{m}+\frac{1}{m^2}.
$$

したがって \(t\) は
$$
t=m,m+1,\ldots,\left\lfloor m+3+\frac{3}{m}\right\rfloor
$$
を動く。

個数は
$$
\left(\left\lfloor m+3+\frac{3}{m}\right\rfloor-m\right)+1
=4+\left\lfloor \frac{3}{m}\right\rfloor.
$$

よって

1. \(m=1\) のとき：\(4+\lfloor 3/1\rfloor=7\) 個
2. \(m=2\) のとき：\(4+\lfloor 3/2\rfloor=5\) 個
3. \(m=3\) のとき：\(4+\lfloor 3/3\rfloor=5\) 個
4. \(4\le m\le 99\) のとき：\(4+\lfloor 3/m\rfloor=4\) 個

##### \(m=100\) のとき

\(p_n=100\) となるのは \(n=10^6\) のみであり、
$$
10^6
$$
は明らかに \(100^2\) の倍数なので \(1\) 個。

以上より総数は
$$
7+5+5+4\times 96+1
$$
$$
=17+384+1
$$
$$
=402.
$$

したがって
$$
\boxed{402}
$$
個である。

#### 3. \(S=\sum_{n=1}^{10^6} q_n\)

再び \(p_n=m\) とし、\(n\) が \(m^2\) の倍数である場合だけを考える。

そのとき
$$
n=m^2t
$$
と書ける。

このとき \(q_n\) は \(n\) を \(m(m+1)\) で割った余りだから、
$$
q_n\equiv m^2t \pmod{m(m+1)}.
$$

ここで
$$
m^2t = m(m+1)t-mt
$$
より
$$
m^2t\equiv -mt \pmod{m(m+1)}.
$$

したがって、\(t\) の値ごとに余りを求めればよい。

##### (i) \(m=1\)

\(n=1,2,\ldots,7\)（すべて該当）で、\(q_n\) は \(2\) で割った余り。

よって
$$
q_1,\ldots,q_7 = 1,0,1,0,1,0,1
$$
なので和は
$$
4.
$$

##### (ii) \(m=2\)

このとき \(t=2,3,4,5,6\)。

対応する \(n=4t\) を \(2\cdot 3=6\) で割った余りは
$$
2,0,4,2,0
$$
だから和は
$$
8.
$$

##### (iii) \(m=3\)

このとき \(t=3,4,5,6,7\)。

対応する \(n=9t\) を \(3\cdot 4=12\) で割った余りは
$$
3,0,9,6,3
$$
だから和は
$$
21.
$$

##### (iv) \(4\le m\le 99\)

このとき 2. より \(t\) は
$$
t=m,m+1,m+2,m+3
$$
の4個である。

各場合の余りを求める。

1. \(t=m\) のとき  
   $$
   m^2t=m^3\equiv m \pmod{m(m+1)}
   $$
   （\(m\equiv -1\pmod{m+1}\) より \(m^2\equiv 1\), よって \(m^3\equiv m\)）

2. \(t=m+1\) のとき  
   $$
   m^2(m+1)
   $$
   は \(m(m+1)\) の倍数なので余りは \(0\)。

3. \(t=m+2\) のとき  
   \(t\equiv 1\pmod{m+1}\) より
   $$
   m^2t\equiv m^2 \pmod{m(m+1)}
   $$
   したがって余りは \(m^2\)。

4. \(t=m+3\) のとき  
   \(t\equiv 2\pmod{m+1}\) より
   $$
   m^2t\equiv 2m^2 \pmod{m(m+1)}.
   $$
   ここで
   $$
   2m^2-m(m+1)=m^2-m=m(m-1)
   $$
   だから余りは \(m(m-1)\)。

よって、固定した \(m\) に対する和は
$$
m+0+m^2+m(m-1)
$$
$$
=m+m^2+m^2-m
$$
$$
=2m^2.
$$

##### (v) \(m=100\)

このとき \(n=10^6\) のみで
$$
q_{10^6}=10^6 \bmod (100\cdot 101)
$$
$$
=10^6 \bmod 10100.
$$

$$
10100\times 99=999900
$$
より
$$
q_{10^6}=100.
$$

##### 総和

以上より
$$
S=4+8+21+\sum_{m=4}^{99}2m^2+100.
$$

まず
$$
\sum_{m=4}^{99}m^2=\sum_{m=1}^{99}m^2-(1^2+2^2+3^2).
$$

公式
$$
\sum_{m=1}^{N}m^2=\frac{N(N+1)(2N+1)}{6}
$$
を用いると
$$
\sum_{m=1}^{99}m^2
=\frac{99\cdot 100\cdot 199}{6}
=328350.
$$

したがって
$$
\sum_{m=4}^{99}m^2=328350-(1+4+9)=328336.
$$

よって
$$
\sum_{m=4}^{99}2m^2=656672.
$$

したがって
$$
S=4+8+21+656672+100
$$
$$
=656805.
$$

よって
$$
\boxed{656805}
$$
である。

## 大問3

### 問題

\(n\) を正の整数とする。次の条件 \((*)\) を満たす \(x\) についての \(n\) 次式 \(P_n(x)\) を考える。
\[
(*)\ \text{すべての実数 }\theta\text{ に対して，}\cos n\theta = P_n(\cos\theta)
\]
次の設問に答えよ。

1. \(n\ge 2\) のとき，\(P_{n+1}(x)\) を \(P_n(x)\) と \(P_{n-1}(x)\) を用いて表せ。
2. \(P_n(x)\) の \(x^{n-2}\) の係数を求めよ。
3. \(\cos\theta=\dfrac{1}{10}\) とする。\(10^{1000}\cos^2(500\theta)\) を \(10\) 進法で表したときの，一の位の数字を求めよ。

### 解答

#### 1. 漸化式

三角関数の加法定理より
$$
\cos((n+1)\theta)+\cos((n-1)\theta)=2\cos\theta\cos(n\theta).
$$

条件 \((*)\) を用いると
$$
P_{n+1}(\cos\theta)+P_{n-1}(\cos\theta)=2\cos\theta\,P_n(\cos\theta).
$$

\(x=\cos\theta\) とおけば
$$
P_{n+1}(x)=2xP_n(x)-P_{n-1}(x)\qquad (n\ge 2).
$$

よって
$$
\boxed{P_{n+1}(x)=2xP_n(x)-P_{n-1}(x)}
$$
である。

#### 2. \(x^{n-2}\) の係数

まず
$$
P_1(x)=x,\qquad P_2(x)=2x^2-1
$$
である。

\(P_n(x)\) の \(x^{n-2}\) の係数を \(c_n\) とおく（\(n\ge 2\)）。

また、\(P_n(x)\) の最高次係数は（漸化式から）\(2^{n-1}\) である。

1. の漸化式
$$
P_{n+1}(x)=2xP_n(x)-P_{n-1}(x)
$$
で \(x^{n-1}\) の係数を比較すると、

- \(2xP_n(x)\) からは \(2c_n\)
- \(-P_{n-1}(x)\) からは \(-2^{\,n-2}\)

が出るので
$$
c_{n+1}=2c_n-2^{\,n-2}.
$$

ここで
$$
P_2(x)=2x^2-1
$$
より
$$
c_2=-1.
$$

\(d_n=\dfrac{c_n}{2^{n-2}}\) とおくと
$$
\frac{c_{n+1}}{2^{n-1}}
=\frac{2c_n-2^{n-2}}{2^{n-1}}
=\frac{c_n}{2^{n-2}}-\frac12.
$$

すなわち
$$
d_{n+1}=d_n-\frac12.
$$

初期値 \(d_2=c_2=-1\) より
$$
d_n=-1-\frac{n-2}{2}=-\frac{n}{2}.
$$

したがって
$$
c_n=2^{n-2}d_n=2^{n-2}\left(-\frac{n}{2}\right)=-n2^{n-3}.
$$

よって、求める係数は
$$
\boxed{-n2^{n-3}}
$$
である。

#### 3. 一の位の数字

まず、倍角公式
$$
\cos^2\phi=\frac{1+\cos 2\phi}{2}
$$
を \(\phi=500\theta\) に適用すると
$$
\cos^2(500\theta)=\frac{1+\cos(1000\theta)}{2}.
$$

したがって
$$
10^{1000}\cos^2(500\theta)
=\frac{10^{1000}+10^{1000}\cos(1000\theta)}{2}.
$$

ここで
$$
a_n=10^nP_n\!\left(\frac{1}{10}\right)
$$
とおく。すると \(\cos\theta=\dfrac{1}{10}\) より
$$
\cos(n\theta)=P_n\!\left(\frac{1}{10}\right)
$$
なので
$$
a_n=10^n\cos(n\theta).
$$

よって
$$
10^{1000}\cos(1000\theta)=a_{1000}.
$$

次に、1. の漸化式に \(x=\dfrac{1}{10}\) を代入すると
$$
P_{n+1}\!\left(\frac{1}{10}\right)
=\frac{2}{10}P_n\!\left(\frac{1}{10}\right)-P_{n-1}\!\left(\frac{1}{10}\right)
$$
$$
=\frac15P_n\!\left(\frac{1}{10}\right)-P_{n-1}\!\left(\frac{1}{10}\right).
$$

両辺に \(10^{n+1}\) を掛けると
$$
a_{n+1}=2a_n-100a_{n-1}.
$$

初期値は
$$
a_0=10^0P_0(1/10)=1,\qquad a_1=10^1\cdot \frac{1}{10}=1.
$$

一の位を求めるため、\(\bmod 20\) で考える（最後に \(2\) で割るため）。

漸化式より
$$
a_{n+1}\equiv 2a_n \pmod{20}
$$
（\(100a_{n-1}\equiv 0\pmod{20}\)）。

また \(a_1=1\) だから
$$
a_n\equiv 2^{n-1}\pmod{20}\qquad (n\ge 1).
$$

よって
$$
a_{1000}\equiv 2^{999}\pmod{20}.
$$

\(2^m\) の \(\bmod 20\) は \(m\ge 2\) で周期 \(4\)（\(4,8,16,12,\ldots\)）なので、
$$
999\equiv 3\pmod{4}
$$
より
$$
2^{999}\equiv 8\pmod{20}.
$$

したがって
$$
a_{1000}\equiv 8\pmod{20}.
$$

また
$$
10^{1000}\equiv 0\pmod{20}
$$
なので
$$
10^{1000}+a_{1000}\equiv 8\pmod{20}.
$$

よって
$$
\frac{10^{1000}+a_{1000}}{2}\equiv \frac{8}{2}=4\pmod{10}.
$$

したがって、求める一の位の数字は
$$
\boxed{4}
$$
である。

---

## 最終答案（穴埋め）

大問1  
$$
\boxed{\text{ア}=\frac53},\quad
\boxed{\text{イ}=-3},\quad
\boxed{\text{ウ}=-6},\quad
\boxed{\text{エ}=\frac65},\quad
\boxed{\text{オ}=63}
$$

大問2  
$$
\boxed{8,\ 12,\ 16,\ 20,\ 24},\quad
\boxed{402},\quad
\boxed{656805}
$$

大問3  
$$
\boxed{P_{n+1}(x)=2xP_n(x)-P_{n-1}(x)},\quad
\boxed{\text{\(x^{n-2}\) の係数 }=-n2^{n-3}},\quad
\boxed{4}
$$
