# 2012年 早稲田大学 商学部 数学 解答

## 大問1

### 1. 問題
次の等式
   \[
   \log_3 x-\frac{1}{\log_9 x}=(-1)^x
   \]
   を満たす正の整数 \(x\) の値は \(\boxed{\text{ア}}\) である。

### 1. 解答
\[
y=\log_3 x
\]
とおく。

\[
\log_9 x=\frac{\log_3 x}{\log_3 9}=\frac{y}{2}
\]
なので
\[
\frac{1}{\log_9 x}=\frac{2}{y}.
\]

よって与式は
\[
y-\frac{2}{y}=(-1)^x
\]
となる。

右辺は \(\pm 1\) なので、場合分けする。

#### (i) \( (-1)^x=1 \) のとき
\[
y-\frac{2}{y}=1
\]
\[
y^2-y-2=0
\]
\[
(y-2)(y+1)=0.
\]

したがって
\[
y=2 \quad \text{または}\quad y=-1.
\]

\(x\) は正の整数より \(y=-1\) は不適（\(x=\frac13\)）。  
\(y=2\) のとき \(x=9\) だが、
\[
(-1)^9=-1
\]
なのでこの場合の仮定に反する。

#### (ii) \( (-1)^x=-1 \) のとき
\[
y-\frac{2}{y}=-1
\]
\[
y^2+y-2=0
\]
\[
(y-1)(y+2)=0.
\]

したがって
\[
y=1 \quad \text{または}\quad y=-2.
\]

\(y=-2\) は不適（\(x=\frac19\)）。  
\(y=1\) のとき
\[
x=3
\]
であり、実際に
\[
(-1)^3=-1
\]
なので適する。

よって
\[
\boxed{3}
\]
である。

### 2. 問題
定数関数でない関数 \(f(x)\) が
   \[
   f(x)=x^2-\int_0^1 (f(t)+x)^2\,dt
   \]
   を満たすとき，\(f(x)=\boxed{\text{イ}}\) である。

### 2. 解答
\[
A=\int_0^1 f(t)^2\,dt,\qquad B=\int_0^1 f(t)\,dt
\]
とおく。

すると
\[
\int_0^1 (f(t)+x)^2\,dt
=\int_0^1 \{f(t)^2+2xf(t)+x^2\}\,dt
\]
\[
=A+2xB+x^2.
\]

よって与式は
\[
f(x)=x^2-(A+2xB+x^2)=-A-2Bx.
\]

したがって \(f(x)\) は 1 次関数である。そこで
\[
f(x)=px+q
\]
とおく。

このとき
\[
B=\int_0^1 (pt+q)\,dt=\frac{p}{2}+q,
\]
\[
A=\int_0^1 (pt+q)^2\,dt
=\int_0^1 (p^2t^2+2pqt+q^2)\,dt
=\frac{p^2}{3}+pq+q^2.
\]

一方、\(f(x)=-A-2Bx\) でもあるから、係数比較より
\[
p=-2B,\qquad q=-A.
\]

まず \(p=-2B\) に \(B=\frac p2+q\) を代入すると
\[
p=-2\left(\frac p2+q\right)=-p-2q
\]
\[
2p+2q=0
\]
\[
q=-p.
\]

次に \(q=-A\) に \(q=-p\) を用いる。

\[
A=\frac{p^2}{3}+p(-p)+(-p)^2=\frac{p^2}{3}.
\]

したがって
\[
q=-A=-\frac{p^2}{3}.
\]

一方 \(q=-p\) なので
\[
-p=-\frac{p^2}{3}
\]
\[
3p=p^2
\]
\[
p(p-3)=0.
\]

定数関数でないので \(p\neq 0\)。よって
\[
p=3,\qquad q=-3.
\]

したがって
\[
\boxed{f(x)=3x-3}
\]
である。

### 3. 問題
\(0^\circ<\theta\le 180^\circ\) とする。数列 \(\{a_n\}\) を次で定める。
   \[
   a_1=\cos\theta,\qquad a_{n+1}=2a_n^2-1
   \]
   このとき，\(a_4=a_5\) となる \(\cos\theta\) の最大値は \(\boxed{\text{ウ}}\) である。

### 3. 解答
（使用する公式）
\[
\cos 2\alpha=2\cos^2\alpha-1
\]
を用いる。

この公式より
\[
a_1=\cos\theta,\quad a_2=\cos 2\theta,\quad a_3=\cos 4\theta,\quad a_4=\cos 8\theta,\quad a_5=\cos 16\theta.
\]

条件 \(a_4=a_5\) は
\[
x=2x^2-1 \qquad (x=a_4)
\]
と同値である。

よって
\[
2x^2-x-1=0
\]
\[
(2x+1)(x-1)=0.
\]

したがって
\[
a_4=1 \quad \text{または}\quad a_4=-\frac12.
\]

つまり
\[
\cos 8\theta=1 \quad \text{または}\quad \cos 8\theta=-\frac12.
\]

#### (i) \(\cos 8\theta=1\)
\[
8\theta=360^\circ k
\]
より
\[
\theta=45^\circ k.
\]

\(0^\circ<\theta\le 180^\circ\) なので
\[
\theta=45^\circ,90^\circ,135^\circ,180^\circ.
\]

このとき \(\cos\theta\) の最大値は
\[
\cos 45^\circ=\frac{\sqrt2}{2}.
\]

#### (ii) \(\cos 8\theta=-\dfrac12\)
\[
8\theta=120^\circ+360^\circ k \quad \text{または}\quad 240^\circ+360^\circ k
\]
より
\[
\theta=15^\circ+45^\circ k \quad \text{または}\quad 30^\circ+45^\circ k.
\]

\(0^\circ<\theta\le 180^\circ\) での候補のうち、\(\cos\theta\) が最大なのは
\[
\theta=15^\circ.
\]

したがって最大値は
\[
\cos 15^\circ=\frac{\sqrt6+\sqrt2}{4}.
\]

よって
\[
\boxed{\frac{\sqrt6+\sqrt2}{4}}
\]
である。

### 4. 問題
体積が \(1\) の正四面体の各辺の中点を頂点とする立八面体の体積は \(\boxed{\text{エ}}\) である。

### 4. 解答
正四面体の各辺の中点を結ぶと、もとの正四面体は
- 頂点側の小さい正四面体 4 個
- 中央の立八面体 1 個

に分割される。

頂点側の小さい正四面体は、もとの正四面体と相似で、相似比は
\[
\frac12
\]
である（各辺の中点を結んでいるため）。

したがって体積比は
\[
\left(\frac12\right)^3=\frac18.
\]

よって小さい正四面体 1 個の体積は
\[
\frac18
\]
であり、4 個あるからその合計体積は
\[
4\cdot \frac18=\frac12.
\]

もとの正四面体の体積が \(1\) なので、中央の立八面体の体積は
\[
1-\frac12=\frac12.
\]

したがって
\[
\boxed{\frac12}
\]
である。

### 大問1 最終答案（穴埋め）
- ア：`3`
- イ：`3x-3`
- ウ：`\dfrac{\sqrt6+\sqrt2}{4}`
- エ：`\dfrac12`

## 大問2

### 問題
座標平面上に \(4\) 点 \(O(0,0),\ A(2,0),\ B(2,1),\ C(0,1)\) がある。実数 \(a\) に対して \(4\) 点 \(P(a+1,a),\ Q(a,a+1),\ R(a-1,a),\ S(a,a-1)\) をとる。このとき，次の設問に答えよ。

1. 長方形 \(OABC\) と正方形 \(PQRS\) が共有点を持つような \(a\) の範囲を求めよ。
2. 長方形 \(OABC\) と正方形 \(PQRS\) の共通部分の面積が最大となる \(a\) の値と，そのときの共通部分の面積を求めよ。

### 解答
長方形 \(OABC\) は
\[
0\le x\le 2,\qquad 0\le y\le 1
\]
である。

また正方形 \(PQRS\) は中心 \((a,a)\)、対角線が座標軸に平行な正方形であり、方程式で表すと
\[
|x-a|+|y-a|\le 1
\]
である。

### 1. 解答
共有点をもつための条件は、点 \((a,a)\) から長方形 \(OABC\) までのマンハッタン距離（\(L^1\) 距離）が \(1\) 以下であることと同値である。

長方形への \(L^1\) 距離は
\[
d(a)=\operatorname{dist}(a,[0,2])+\operatorname{dist}(a,[0,1])
\]
となる。

場合分けすると

- \(a\le 0\) のとき
  \[
  d(a)=(-a)+(-a)=-2a
  \]
- \(0\le a\le 1\) のとき
  \[
  d(a)=0
  \]
- \(1\le a\le 2\) のとき
  \[
  d(a)=0+(a-1)=a-1
  \]
- \(a\ge 2\) のとき
  \[
  d(a)=(a-2)+(a-1)=2a-3
  \]

共有点をもつ条件は \(d(a)\le 1\) だから、

- \(a\le 0\) では \(-2a\le 1 \Rightarrow a\ge -\frac12\)
- \(0\le a\le 1\) では常に可
- \(1\le a\le 2\) では \(a-1\le 1\)（常に可）
- \(a\ge 2\) では \(2a-3\le 1 \Rightarrow a\le 2\)

より、全体として
\[
\boxed{-\frac12\le a\le 2}
\]
である。

### 2. 解答
共通部分の面積を \(S(a)\) とする。

#### (i) \(-\dfrac12\le a\le 0\)
このとき共通部分は、原点 \(O\) 付近の直角二等辺三角形になる。
境界直線は
\[
x+y=2a+1
\]
なので、面積は
\[
S(a)=\frac{(2a+1)^2}{2}.
\]

#### (ii) \(0\le a\le \dfrac12\)
縦切りで面積を求める（途中式を省略しないため積分で計算する）。

この範囲では
\[
S(a)=\int_0^{2a}1\,dx+\int_{2a}^{1}(2a+1-x)\,dx+\int_1^{a+1}2(a+1-x)\,dx.
\]

各項を計算すると
\[
\int_0^{2a}1\,dx=2a,
\]
\[
\int_{2a}^{1}(2a+1-x)\,dx=\frac12-2a^2,
\]
\[
\int_1^{a+1}2(a+1-x)\,dx=a^2.
\]

したがって
\[
S(a)=2a+\left(\frac12-2a^2\right)+a^2
=\frac12+2a-a^2.
\]

#### (iii) \(\dfrac12\le a\le 1\)
同様に縦切りで計算すると
\[
S(a)=\int_0^{2a-1}(2-2a+x)\,dx+\int_{2a-1}^{1}1\,dx+\int_1^{2a}(2-x)\,dx+\int_{2a}^{a+1}2(a+1-x)\,dx.
\]

各項を計算して整理すると
\[
S(a)=4a-3a^2.
\]

#### (iv) \(1\le a\le 2\)
このとき共通部分は点 \(B(2,1)\) 付近の四角形（実際には 2 つの直角三角形の和）になる。
縦切りで計算すると
\[
S(a)=\int_{2a-2}^{a}(x-2a+2)\,dx+\int_{a}^{2}(2-x)\,dx.
\]

それぞれ同じ面積の三角形なので
\[
S(a)=\frac{(2-a)^2}{2}+\frac{(2-a)^2}{2}=(2-a)^2.
\]

#### 最大値を求める
各区間で調べる。

- \(-\dfrac12\le a\le 0\): \(\dfrac{(2a+1)^2}{2}\) は最大でも \(\dfrac12\)
- \(0\le a\le \dfrac12\): \(\dfrac12+2a-a^2\) は増加（この区間では頂点 \(a=1\) より左）
- \(\dfrac12\le a\le 1\): \(4a-3a^2\) は下に凸の二次式で、頂点は
  \[
  a=\frac{4}{2\cdot 3}=\frac23
  \]
- \(1\le a\le 2\): \((2-a)^2\) は \(a=1\) で最大 \(1\)

したがって全体の最大値は \(a=\dfrac23\) のときで
\[
S\left(\frac23\right)=4\cdot \frac23-3\left(\frac23\right)^2
=\frac83-\frac43
=\frac43.
\]

よって
\[
\boxed{a=\frac23,\quad \text{最大面積 } \frac43}
\]
である。

### 大問2 最終答案
1. `-\dfrac12\le a\le 2`
2. `a=\dfrac23`, 最大面積 `\dfrac43`

## 大問3

### 問題
平面上に点 \(O,\ A_1,\ A_2,\ A_3,\ \ldots,\ A_{100}\) がある。ただし，同じ点があってもよい。また，平面上の点 \(P\) に対して，
\[
f(P)=\sum_{i=1}^{100}\left|\overrightarrow{PA_i}\right|^2
\]
とする。また，\(f(P)\) の最小値を \(m\) とし，平面上の点 \(C\) は \(f(C)=m\) を満たすとする。このとき，次の設問に答えよ。

1. \(\overrightarrow{a_i}=\overrightarrow{OA_i}\ (i=1,2,3,\ldots,100)\) とするとき，\(\overrightarrow{OC}\) を \(\overrightarrow{a_i}\) を用いて表せ。
2. 次の条件
   \[
   (*)\ \sum_{i=1}^{100}\left(\sum_{j=1}^{100}|\overrightarrow{A_iA_j}|^2\right)
   =\sum_{j=1}^{100}|\overrightarrow{A_1A_j}|^2+\sum_{j=1}^{100}|\overrightarrow{A_2A_j}|^2+\cdots+\sum_{j=1}^{100}|\overrightarrow{A_{100}A_j}|^2=4000
   \]
   が成立しているときの \(m\) の値を求めよ。
3. (2)における条件 \((*)\) が成立しているとき，集合
   \[
   \{A_i\mid |\overrightarrow{CA_i}|\ge 2,\ 1\le i\le 100,\ i\text{ は整数}\}
   \]
   の要素の個数の最大値を求めよ。

### 解答
### 1. 解答
\[
\overrightarrow{OP}=\overrightarrow{p}
\]
とおき、\(\overrightarrow{OA_i}=\overrightarrow{a_i}\) とする。

すると
\[
f(P)=\sum_{i=1}^{100}|\overrightarrow{PA_i}|^2
=\sum_{i=1}^{100}|\overrightarrow{a_i}-\overrightarrow{p}|^2.
\]

これを展開すると
\[
f(P)=\sum_{i=1}^{100}\left(|\overrightarrow{a_i}|^2-2\overrightarrow{a_i}\cdot \overrightarrow{p}+|\overrightarrow{p}|^2\right)
\]
\[
=\sum_{i=1}^{100}|\overrightarrow{a_i}|^2-2\left(\sum_{i=1}^{100}\overrightarrow{a_i}\right)\cdot \overrightarrow{p}+100|\overrightarrow{p}|^2.
\]

平方完成の形にすると、\(f(P)\) は
\[
\overrightarrow{p}=\frac{1}{100}\sum_{i=1}^{100}\overrightarrow{a_i}
\]
のとき最小となる。

よって
\[
\boxed{\overrightarrow{OC}=\frac{1}{100}\sum_{i=1}^{100}\overrightarrow{a_i}}
\]
である。

### 2. 解答
点 \(C\) を基準に
\[
\overrightarrow{u_i}=\overrightarrow{CA_i}\qquad (i=1,2,\ldots,100)
\]
とおく。

1. より \(C\) は重心なので
\[
\sum_{i=1}^{100}\overrightarrow{u_i}=\overrightarrow{0}. \tag{1}
\]

また
\[
m=f(C)=\sum_{i=1}^{100}|\overrightarrow{u_i}|^2. \tag{2}
\]

条件 \((*)\) の左辺は
\[
\sum_{i=1}^{100}\sum_{j=1}^{100}|\overrightarrow{A_iA_j}|^2
=\sum_{i=1}^{100}\sum_{j=1}^{100}|\overrightarrow{u_j}-\overrightarrow{u_i}|^2.
\]

これを展開すると
\[
\sum_{i,j}\left(|\overrightarrow{u_i}|^2+|\overrightarrow{u_j}|^2-2\overrightarrow{u_i}\cdot \overrightarrow{u_j}\right).
\]

ここで
\[
\sum_{i,j}|\overrightarrow{u_i}|^2=100\sum_i |\overrightarrow{u_i}|^2,
\qquad
\sum_{i,j}|\overrightarrow{u_j}|^2=100\sum_j |\overrightarrow{u_j}|^2
\]
より前2項の和は
\[
200\sum_{i=1}^{100}|\overrightarrow{u_i}|^2=200m.
\]

また第3項は
\[
2\sum_{i,j}\overrightarrow{u_i}\cdot \overrightarrow{u_j}
=2\left(\sum_i \overrightarrow{u_i}\right)\cdot \left(\sum_j \overrightarrow{u_j}\right)=0
\]
（(1) を使用）。

したがって
\[
\sum_{i=1}^{100}\sum_{j=1}^{100}|\overrightarrow{A_iA_j}|^2=200m.
\]

条件 \((*)\) によりこれが \(4000\) に等しいから
\[
200m=4000
\]
\[
m=20.
\]

よって
\[
\boxed{20}
\]
である。

### 3. 解答
(2) より
\[
\sum_{i=1}^{100}|\overrightarrow{CA_i}|^2=m=20.
\]

いま
\[
|\overrightarrow{CA_i}|\ge 2
\]
である点の個数を \(k\) 個とすると、その各点について
\[
|\overrightarrow{CA_i}|^2\ge 4
\]
であるから
\[
20=\sum_{i=1}^{100}|\overrightarrow{CA_i}|^2 \ge 4k.
\]

したがって
\[
k\le 5.
\]

次に \(k=5\) が実現できることを示す。  
例えば
- \(A_1,\ldots,A_5\) を \(C\) から距離 \(2\) の同一点にとる
- \(A_6,\ldots,A_{100}\) を \(C\) と一致させる

とすると
\[
\sum_{i=1}^{100}|\overrightarrow{CA_i}|^2=5\cdot 2^2=20
\]
となり、(2) の条件を満たす。よって \((*)\) も満たされる。

このとき \(|\overrightarrow{CA_i}|\ge 2\) の点はちょうど 5 個である。

よって最大値は
\[
\boxed{5}
\]
である。

### 大問3 最終答案
1. `\overrightarrow{OC}=\dfrac{1}{100}\sum_{i=1}^{100}\overrightarrow{a_i}`
2. `m=20`
3. `5`
