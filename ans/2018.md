# 2018年 早稲田大学 商学部 数学 解答

## 大問1

### 1. 問題

\(a,k\) を実数とする。実数 \(x\) についての方程式
\[
|x-1|-ax+k^2+ak-2=0
\]
が，定数 \(a\) がどのような実数であっても必ず解をもつような \(k\) の最大値を求めよ。

### 1. 解答

方程式の左辺を
$$
F_a(x)=|x-1|-ax+k^2+ak-2
$$
とおく。

求める条件は

「任意の実数 \(a\) に対し，方程式 \(F_a(x)=0\) が実数解をもつ」

である。

#### (i) \(|a|>1\) のとき

\(x\ge 1\) では
$$
F_a(x)=(1-a)x+k^2+ak-3,
$$
\(x\le 1\) では
$$
F_a(x)=-(a+1)x+k^2+ak-1.
$$

- \(a>1\) のとき：\(x\to +\infty\) で \(F_a(x)\to -\infty\)、\(x\to -\infty\) で \(F_a(x)\to +\infty\)
- \(a<-1\) のとき：\(x\to +\infty\) で \(F_a(x)\to +\infty\)、\(x\to -\infty\) で \(F_a(x)\to -\infty\)

となるので、いずれも中間値の定理より必ず実数解をもつ。

したがって条件を調べるべきなのは
$$
-1\le a\le 1
$$
の場合だけでよい。

#### (ii) \(-1\le a\le 1\) のとき

このとき
- 左側の傾き \(-a-1\le 0\)
- 右側の傾き \(1-a\ge 0\)

であるから、\(F_a(x)\) は \(x=1\) で最小値をとる。

よって実数解をもつための必要十分条件は
$$
F_a(1)\le 0
$$
である。

計算すると
$$
F_a(1)=|1-1|-a+k^2+ak-2=k^2+(k-1)a-2.
$$

これがすべての \(a\in[-1,1]\) で \(\le 0\) となるためには、\(a\) に関する一次式の最大値が \(\le 0\) であればよいから
$$
k^2+|k-1|-2\le 0.
$$

これを解く。

- \(k\ge 1\) のとき
  $$
  k^2+(k-1)-2=k^2+k-3\le 0
  $$
  より
  $$
  k\le \frac{-1+\sqrt{13}}{2}.
  $$

- \(k<1\) のとき
  $$
  k^2+(1-k)-2=k^2-k-1\le 0
  $$
  だが、最大値を求めるので上の範囲の方が大きい。

したがって、求める \(k\) の最大値は
$$
\boxed{\frac{\sqrt{13}-1}{2}}
$$
である。

### 2. 問題

次の条件を満たす正の整数の組 \((a,b,n)\) をすべて求めよ。
\[
n\ge 2,\qquad b\text{ は素数},\qquad a^2=b^n+225
\]

### 2. 解答

与式を変形すると
$$
a^2-15^2=b^n
$$
すなわち
$$
(a-15)(a+15)=b^n.
$$

ここで \(b\) は素数なので、左辺の2因子 \(a-15\), \(a+15\) はともに \(b\) の冪である。

よって
$$
a-15=b^u,\qquad a+15=b^v \quad (0\le u<v,\ u+v=n)
$$
とおける。

2式の差をとると
$$
b^v-b^u=30
$$
$$
b^u(b^{v-u}-1)=30.
$$

したがって
$$
b^u\mid 30.
$$

#### 場合分け

##### 1. \(u=0\) のとき

$$
b^v-1=30
$$
より
$$
b^v=31.
$$
したがって \(b=31,\ v=1\) だが、このとき
$$
n=u+v=1
$$
となり、条件 \(n\ge 2\) に反する。

よって不適。

##### 2. \(u\ge 1\) のとき

\(b^u\mid 30\) より、素数 \(b\) は
$$
b=2,3,5
$$
のみ。

- \(b=2\) のとき
  $$
  2^u(2^{v-u}-1)=30.
  $$
  左辺の奇数因子 \(2^{v-u}-1\) は奇数なので、\(2^u\) は \(30\) の2冪部分 \(2\) に等しい。よって \(u=1\)。
  すると
  $$
  2(2^{v-1}-1)=30
  $$
  $$
  2^{v-1}-1=15
  $$
  $$
  2^{v-1}=16
  $$
  $$
  v=5.
  $$
  よって
  $$
  a=15+2=17,
  $$
  $$
  n=u+v=1+5=6.
  $$

- \(b=3\) のとき
  \(3^u\mid 30\) より \(u=1\)。
  すると
  $$
  3(3^{v-1}-1)=30
  $$
  $$
  3^{v-1}-1=10
  $$
  となるが不可能。

- \(b=5\) のとき
  同様に \(u=1\) で
  $$
  5(5^{v-1}-1)=30
  $$
  $$
  5^{v-1}-1=6
  $$
  となるが不可能。

以上より唯一の組は
$$
\boxed{(a,b,n)=(17,2,6)}
$$
である。

### 3. 問題

正の整数 \(m\) と，定数関数でない \(x\) の整式で表された関数 \(P(x)\) が，次の条件を満たしている。
\[
\text{すべての実数 }x\text{ に対して}\quad \int_0^x \{P(t)\}^m\,dt=P(x^3)-P(0)
\]
このとき \(P(x)\) を求めよ。

### 3. 解答

与式を
$$
\int_0^x (P(t))^m\,dt=P(x^3)-P(0)
$$
と書く。

両辺を \(x\) で微分すると（微積分の基本定理、合成関数の微分）
$$
(P(x))^m=3x^2P'(x^3).
$$

#### 次数比較

\(\deg P=d\ (\ge 1)\) とする（定数関数でないので \(d\ge 1\)）。

- 左辺の次数：\(md\)
- 右辺の次数：\(P'(x^3)\) の次数は \(3(d-1)\)、さらに \(3x^2\) を掛けるので
  $$
  3(d-1)+2=3d-1.
  $$

したがって
$$
md=3d-1
$$
$$
d(m-3)=-1.
$$

左辺は整数であるから、これが成り立つのは
$$
d=1,\ m=2
$$
のみである。

よって
$$
P(x)=ax+b\qquad (a\ne 0)
$$
とおける。

#### 係数比較

\(m=2\) を元の式に代入する。

左辺：
$$
\int_0^x (at+b)^2dt
=\int_0^x (a^2t^2+2abt+b^2)\,dt
$$
$$
=\frac{a^2}{3}x^3+abx^2+b^2x.
$$

右辺：
$$
P(x^3)-P(0)=(ax^3+b)-b=ax^3.
$$

よって
$$
\frac{a^2}{3}x^3+abx^2+b^2x=ax^3.
$$
係数比較より
$$
ab=0,\quad b^2=0,\quad \frac{a^2}{3}=a.
$$

まず \(b^2=0\) より \(b=0\)。
また \(a\ne 0\) だから
$$
\frac{a^2}{3}=a \Rightarrow a=3.
$$

したがって
$$
\boxed{P(x)=3x}
$$
である。

### 4. 問題

実数全体の集合を定義域とする定数関数でない \(x\) の関数 \(f(x)\) が，次の条件

すべての実数 \(x\) に対して，\(f(-x)=-f(x),\ f(1+x)=f(1-x)\)

を満たしている。このとき，次の条件

すべての実数 \(x\) に対して，\(f(x+n)=f(x)\)

を満たすような正の整数 \(n\) の最小値を求めよ。

### 4. 解答

条件より

1. 奇関数：
   $$
   f(-x)=-f(x)
   $$
2. \(x=1\) に関して対称：
   $$
   f(1+x)=f(1-x)
   $$

が成り立つ。

2つ目の条件で、\(x\) を \(x+1\) に置き換えると
$$
f(2+x)=f(-x).
$$

ここで奇関数性を用いると
$$
f(-x)=-f(x)
$$
だから
$$
f(x+2)=-f(x).
$$

さらにもう一度 \(x\to x+2\) とすると
$$
f(x+4)=-f(x+2)=f(x).
$$

したがって、どのような関数 \(f\) でも必ず
$$
\boxed{4}
$$
を周期にもつ。

次に、これより小さい正の整数が必ず周期になるとは限らないことを示す。

例えば
$$
f(x)=\sin\frac{\pi x}{2}
$$
とすると、

- 奇関数である。
- 
  $$
  f(1+x)=\sin\left(\frac{\pi}{2}+\frac{\pi x}{2}\right)=\cos\frac{\pi x}{2},
  $$
  $$
  f(1-x)=\sin\left(\frac{\pi}{2}-\frac{\pi x}{2}\right)=\cos\frac{\pi x}{2}
  $$
  より条件を満たす。

しかし
$$
f(x+2)=\sin\left(\frac{\pi x}{2}+\pi\right)=-f(x)
$$
であり、一般には \(f(x+2)\ne f(x)\) である。

よって最小の正の整数 \(n\) は
$$
\boxed{4}
$$
である。

## 大問2

### 問題

実数 \(x\) に対して，数列 \(\{a_k(x)\}\) を次で定義する。
\[
a_1(x)=x,\qquad a_{k+1}(x)=2a_k(x)-[\,2a_k(x)\,]\qquad (k=1,2,3,\ldots)
\]
ただし，実数 \(t\) に対して \([t]\) は \(t\) 以下の最大の整数を表す。正の整数 \(n\) に対して，\(S_n\) を次の条件 \((*)\) を満たす有理数 \(\dfrac{i}{n}\)（\(i\) は \(1\) 以上 \(n-1\) 以下の整数）全体の集合とする。

\((*)\) ある正の整数 \(k\) が存在して，\(a_k\!\left(\dfrac{i}{n}\right)=0\)

次の設問に答えよ。

1. \(S_{12}\) を求めよ。
2. \(S_1,S_2,S_3,\ldots,S_{2018}\) の少なくとも \(1\) つに属する要素全体の集合を \(T\) とするとき，\(T\) の要素の個数を求めよ。

### 解答

まず、定義より
$$
a_{k+1}(x)=\{2a_k(x)\}
$$
（\(\{\cdot\}\) は小数部分）である。よって帰納的に
$$
a_k(x)=\{2^{k-1}x\}
$$
となる。

したがって
$$
a_k(x)=0
$$
となるのは
$$
2^{k-1}x \text{ が整数}
$$
のときである。

#### 補題（条件 \((*)\) の判定）

既約分数で
$$
x=\frac{p}{q}\qquad (\gcd(p,q)=1)
$$
と書くと、条件 \((*)\) は
$$
q \text{ が }2\text{ の冪}
$$
であることと同値である。

理由：
$$
a_k(x)=0 \iff 2^{k-1}\frac{p}{q}\in \mathbb{Z}
$$
$$
\iff q\mid 2^{k-1}p.
$$
\(\gcd(p,q)=1\) より
$$
q\mid 2^{k-1}
$$
となるから、\(q\) は2の冪である。逆も明らか。

#### 1. \(S_{12}\)

\(\dfrac{i}{12}\ (1\le i\le 11)\) を既約分数にしたときの分母が2の冪になればよい。

実際に調べると
$$
\frac{3}{12}=\frac14,
\qquad
\frac{6}{12}=\frac12,
\qquad
\frac{9}{12}=\frac34
$$
のみが該当する。

よって
$$
\boxed{S_{12}=\left\{\frac14,\ \frac12,\ \frac34\right\}}
$$
である。

#### 2. \(T\) の要素数

補題より、\(T\) の要素は

「\(0<x<1\) の有理数で、既約分数にした分母が2の冪、かつその分母が \(2018\) 以下」

にちょうど一致する。

\(2018\) 以下の最大の2の冪は
$$
2^{10}=1024
$$
である。

したがって、分母が \(2^r\)（既約）となるものは
$$
r=1,2,\ldots,10
$$
について数えればよい。

分母が \(2^r\) の既約分数 \(\dfrac{m}{2^r}\)（\(0<m<2^r\)）の個数は、\(m\) が奇数である個数に等しいので
$$
2^{r-1}
$$
個である（\(\varphi(2^r)=2^{r-1}\)）。

よって
$$
|T|=\sum_{r=1}^{10}2^{r-1}
=1+2+4+\cdots+512.
$$

等比数列の和より
$$
|T|=2^{10}-1=1023.
$$

したがって
$$
\boxed{1023}
$$
である。

## 大問3

### 問題

原点を \(O(0,0)\) とする座標平面上の \(9\) 点を，
\[
P_k\left(\cos\frac{2\pi k}{9},\ \sin\frac{2\pi k}{9}\right)\qquad (k=1,2,3,\ldots,9)
\]
とする。異なる \(2\) 点の組 \((P_i,P_j)\) に対して，点列 \(A_n\)（\(n=1,2,3,\ldots\)）を次で定義する。

(i) \((A_1,A_2)=(P_i,P_j)\)  
(ii) 直線 \(OA_n\) は線分 \(A_{n+1}A_{n+2}\) の垂直二等分線（\(n=1,2,3,\ldots\)）

次の設問に答えよ。

1. \((A_1,A_2)=(P_1,P_2)\) とする。\(A_{15}=P_k\) のとき，\(k\) を求めよ。
2. すべての正の整数 \(n\) に対して，\(A_n\ne P_1\) となるような，組 \((A_1,A_2)\) の個数を求めよ。

### 解答

各 \(A_n\) は常に円周上の点 \(P_k\) になる。実際、条件 (ii) より \(A_{n+2}\) は \(A_{n+1}\) を直線 \(OA_n\) に関して対称移動した点であり、原点中心の単位円はこの対称移動で不変だからである。

よって
$$
A_n=P_{k_n}
$$
と書ける（\(k_n\) は \(9\) を法として考える）。

#### 反射による漸化式

正九角形の頂点 \(P_{k_{n+1}}\) を、原点を通る直線 \(OP_{k_n}\) に関して対称移動すると、添字は
$$
k_{n+2}\equiv 2k_n-k_{n+1}\pmod 9
$$
となる。

したがって
$$
\boxed{k_{n+2}\equiv 2k_n-k_{n+1}\pmod 9}
$$
が成り立つ。

ここで差を
$$
d_n=k_{n+1}-k_n
$$
とおくと
$$
d_{n+1}=k_{n+2}-k_{n+1}\equiv (2k_n-k_{n+1})-k_{n+1}
= -2(k_{n+1}-k_n)
= -2d_n
pmod 9.
$$

よって
$$
\boxed{d_{n+1}\equiv -2d_n\pmod 9}.
$$

### 1. \((A_1,A_2)=(P_1,P_2)\) のとき

このとき
$$
k_1=1,\ k_2=2,\ d_1=1.
$$

よって
$$
d_n\equiv (-2)^{n-1}\pmod 9.
$$

\(-2\equiv 7\pmod 9\) であり、
$$
7^1\equiv 7,\ 7^2\equiv 4,\ 7^3\equiv 1\pmod 9
$$
なので、\(d_n\) は周期3で
$$
1,7,4,1,7,4,\ldots
$$
と巡回する。

したがって
$$
k_{15}=k_1+\sum_{m=1}^{14}d_m.
$$

3項ずつの和は
$$
1+7+4=12\equiv 3\pmod 9.
$$
14項は「12項＋2項」なので
$$
\sum_{m=1}^{14}d_m \equiv 4\times 3 + (1+7) =12+8=20\equiv 2\pmod 9.
$$

よって
$$
k_{15}\equiv 1+2=3\pmod 9.
$$

したがって
$$
\boxed{k=3}
$$
である。

### 2. すべての \(n\) で \(A_n\ne P_1\) となる組の個数

初期値を
$$
k_1=i,\ k_2=j \ (i\ne j)
$$
とし、
$$
d=j-i \pmod 9
$$
とおく（\(d\not\equiv 0\pmod 9\)）。

すると
$$
d_n\equiv (-2)^{n-1}d \equiv 7^{n-1}d \pmod 9.
$$

よって
$$
k_n\equiv i+d s_{n-1}\pmod 9
$$
ただし
$$
s_m=1+7+7^2+\cdots+7^{m-1} \pmod 9\quad (s_0=0)
$$
とおく。

実際に \(s_m\ (m=0,1,\ldots,8)\) を並べると
$$
0,1,8,3,4,2,6,7,5
$$
となり、これは \(0,1,2,\ldots,8\) のすべてをちょうど1回ずつ含む。

したがって、\(k_n\) が取りうる値は
$$
i+d\cdot (\text{全ての剰余}) \pmod 9
$$
で決まる。

#### 場合分け

##### (i) \(d\not\equiv 0\pmod 3\) のとき

\(d\) は \(9\) と互いに素なので、\(d\cdot (\text{全ての剰余})\) も全剰余を動く。
したがって \(k_n\) は \(1\) を必ずとる。

よって不適。

##### (ii) \(d\equiv 3\) または \(6\pmod 9\) のとき

このとき \(d\) は \(3\) の倍数なので、\(k_n\) は常に
$$
k_n\equiv i \pmod 3
$$
を満たす。

したがって \(k_n\equiv 1\pmod 9\)（つまり \(A_n=P_1\)）を避けるためには
$$
i\not\equiv 1\pmod 3
$$
であればよい。

\(1,2,\ldots,9\) のうち \(i\not\equiv 1\pmod 3\) となるものは
$$
6\text{ 個}
$$
ある。

固定した \(i\) に対して、\(d\equiv 3,6\pmod 9\) に対応する \(j\) は
$$
2\text{ 個}
$$
ある。

よって求める組の個数は
$$
6\times 2=12.
$$

したがって
$$
\boxed{12}
$$
である。

---

## 最終答案（穴埋め）

大問1  
$$
\boxed{\text{ア}=\frac{\sqrt{13}-1}{2}},\quad
\boxed{\text{イ}=(17,2,6)},\quad
\boxed{\text{ウ}=3x},\quad
\boxed{\text{エ}=4}
$$

大問2  
$$
\boxed{S_{12}=\left\{\frac14,\frac12,\frac34\right\}},\quad
\boxed{|T|=1023}
$$

大問3  
$$
\boxed{k=3},\quad \boxed{12}
$$


